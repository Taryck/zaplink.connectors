<?xml version="1.0" encoding="utf-16"?>
<CONTAINER NAME="ZAPLINK_PROGRAM" VERSION="1.0" CLASS="ZAPLINK_CONTAINER">
 <ZL_OBJECT CHECKSUM="A5DDB7AC148C6359D3D561B7580D3D4E" CODE_SIGNATURE="AC6074D9CAC0746630195FA880391795" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_MENUPAINTER_DATA" TYPE="CLAS" VERSION="1.01">
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20100217" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="701">
    <TEXTS>
     <ITEM LANG="E" TEXT="Menu painter Data">U1&amp;FUNCTIONALITY&amp;
ASIs part of connector : ZAPLINK_PROGRAM
ASDefine XML structure of a Menu painter, that is used in Programs and
  Objects.
U1&amp;RELATIONS&amp;
AS
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AShttp://help.sap.com/saphelp_nw04/Helpdata/EN/9f/dba99935c111d1829f0000e8
= 29fbfe/content.htm
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
    </TEXTS>
   </A0_MAINDATA>
   <ALIASES>
    <ITEM CMPNAME="TD_DOC_ID" VERSION="1" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DOC_ID"/>
    <ITEM CMPNAME="TD_PROGNAME" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_PROGNAME"/>
    <ITEM CMPNAME="TR_DOCID" VERSION="1" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_DOCID"/>
    <ITEM CMPNAME="TT_TEXTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TEXTS"/>
   </ALIASES>
   <ATTRIBUTS>
    <ITEM CMPNAME="BAR" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="GUI_FUNC" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Bar Menu code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="DEFAULT_BAR" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="GUI_FUNC" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Default Bar Menu code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="DEFAULT_FUNCTION" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="9 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="GUI_FUNC" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Default function Menu code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="DOC_IDS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF doc_ids,
      header TYPE td_doc_id VALUE &apos;DO&apos;,
    END OF doc_ids
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Documentation IDS"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="FUNCTION" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="GUI_FUNC" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Function&apos;s Menu code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="FUNCTIONS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="15 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_FUNCTIONS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Functions"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="KEY_SETTINGS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="14 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_KEYBOARDS" R3RELEASE="701"/>
    <ITEM CMPNAME="MASTER_LANG" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="10 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="SPRSL" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Master Language"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="MENU" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="GUI_FUNC" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Menu code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="MENU_BARS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="13 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_BARS" R3RELEASE="701"/>
    <ITEM CMPNAME="MENU_LIST" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="12 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_MENUS" R3RELEASE="701"/>
    <ITEM CMPNAME="OBJ_TYPES" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF obj_types,   &quot; FROM Include RSMPECON
      menu      TYPE mp_o_type VALUE &apos;M&apos;,
      function  TYPE mp_o_type VALUE &apos;F&apos;,
      title     TYPE mp_o_type VALUE &apos;T&apos;,
      menu_bar  TYPE mp_o_type VALUE &apos;A&apos;,
      key_set   TYPE mp_o_type VALUE &apos;P&apos;,  &quot; Function Key Setting
      button    TYPE mp_o_type VALUE &apos;B&apos;,  &quot; Pushbutton settings
      status    TYPE mp_o_type VALUE &apos;C&apos;,
      separator TYPE mp_o_type VALUE &apos;S&apos;,
      icon      TYPE mp_o_type VALUE &apos;I&apos;,
      program   TYPE mp_o_type VALUE &apos;D&apos;,
      dynpro    TYPE mp_o_type VALUE &apos;E&apos;,
      text      TYPE mp_o_type VALUE &apos;Z&apos;,
      context   TYPE mp_o_type VALUE &apos;X&apos;,
      symbolbar TYPE mp_o_type VALUE &apos;Y&apos;,
    END OF obj_types
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Menu Painter: Standards maintenance: Object type"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="R_DOC_IDS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="1" TYPTYPE="1" TYPE="TR_DOCID" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Range : Documentation IDS"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="STATUS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="11 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_STATUS" R3RELEASE="701"/>
    <ITEM CMPNAME="TEXT_TYPES" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF text_types,
      object      TYPE mp_txttype VALUE &apos;M&apos;,
      icon        TYPE mp_txttype VALUE &apos;I&apos;,
      quick_info  TYPE mp_txttype VALUE &apos;Q&apos;,
      tech_info   TYPE mp_txttype VALUE &apos;T&apos;,  &quot; Technical Information
    END OF text_types
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Menu Painter: Text type"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TITLES" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="16 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_TITLES" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Title bars"/>
     </TEXTS>
    </ITEM>
   </ATTRIBUTS>
   <FRIENDS>
    <ITEM REFCLSNAME="ZAPLINK_EASYXML" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
   </FRIENDS>
   <INTERFACES>
    <ITEM REFCLSNAME="ZAPLINK_DATATYPES" VERSION="1" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018" RELTYPE="1"/>
   </INTERFACES>
   <LOCAL>
    <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE
 CLASS zaplink_documentation DEFINITION LOAD.</TYPES>
    <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
    <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS</MACROS>
   </LOCAL>
   <METHODS>
    <ITEM CMPNAME="ANONYMIZE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Anonymized component data"/>
     </TEXTS>
     <SOURCE>`
*  FIELD-SYMBOLS:
*    &lt;t&gt; like LINE OF texts.
*
*  clear: a0_maindata-AS4USER, a0_maindata-AS4DATE, a0_maindata-AS4TIME.
*  loop at texts ASSIGNING &lt;t&gt;.
*    clear: &lt;t&gt;-LONG_TXT-TDFUSER, &lt;t&gt;-LONG_TXT-TDFDATE, &lt;t&gt;-LONG_TXT-TDFTIME.
*  endloop.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="CLASS_CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDTYPE="2" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="CLASS_CONSTRUCTOR"/>
     </TEXTS>
     <SOURCE>`
  DATA _id LIKE LINE OF r_doc_ids.

  _id-sign = &apos;I&apos;. _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-header. APPEND _id TO r_doc_ids.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="FROM_DATA" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert FM Data to object attributes"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Modules object Data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA t_tmp   TYPE tt_atrt.
  DATA t_attr  TYPE SORTED TABLE OF rsmpe_atrt WITH UNIQUE KEY obj_code sub_code obj_type.
  DATA s_attr  LIKE LINE OF t_attr.
  DATA t_tmp_m TYPE tt_mnlt.
  DATA t_menus TYPE SORTED TABLE OF rsmpe_mnlt WITH UNIQUE KEY code.
  DATA s_mnu   LIKE LINE OF t_menus.
  DATA s_title LIKE LINE OF titles.
  DATA s_func  LIKE LINE OF functions.
  DATA s_statu LIKE LINE OF status.
  DATA s_s_fu  LIKE LINE OF s_statu-functions.
  DATA s_menu  LIKE LINE OF menu_list.
  DATA s_m_det LIKE LINE OF s_menu-composition.
  DATA s_bar   LIKE LINE OF menu_bars.
  DATA s_b_det LIKE LINE OF s_bar-composition.
  DATA s_key   LIKE LINE OF key_settings.
  DATA s_k_det LIKE LINE OF s_key-keys.
  DATA s_but   LIKE LINE OF s_key-pushbuttons.
  DATA s_u_det LIKE LINE OF s_but-composition.
  FIELD-SYMBOLS:
    &lt;k&gt;  LIKE LINE OF key_settings,
    &lt;at&gt; LIKE LINE OF fm_data-attributes,
    &lt;bd&gt; LIKE LINE OF fm_data-bars_det,
    &lt;kb&gt; LIKE LINE OF fm_data-keyboards,
    &lt;bu&gt; LIKE LINE OF fm_data-buttons_det,
    &lt;sf&gt; LIKE LINE OF fm_data-stat_funcs,
    &lt;st&gt; LIKE LINE OF fm_data-status,
    &lt;mn&gt; LIKE LINE OF fm_data-menus,
    &lt;md&gt; LIKE LINE OF fm_data-menus_det,
    &lt;fu&gt; LIKE LINE OF fm_data-functions,
    &lt;ti&gt; LIKE LINE OF fm_data-titles.

  bar = fm_data-header-actcode.
  menu = fm_data-header-mencode.
  function = fm_data-header-pfkcode.
  default_bar = fm_data-header-defaultact.
  default_function = fm_data-header-defaultpfk.
  master_lang = fm_data-header-mod_langu.

  LOOP AT fm_data-titles ASSIGNING &lt;ti&gt;.
    CLEAR s_title.
    MOVE-CORRESPONDING &lt;ti&gt; TO s_title-hdr.
    s_title-texts = get_texts( texts = fm_data-texts
                            obj_type = obj_types-title
                            obj_code = s_title-code
                            sub_code = space
                            texttype = text_types-tech_info ).
    INSERT s_title INTO TABLE titles.
  ENDLOOP.

  LOOP AT fm_data-functions ASSIGNING &lt;fu&gt;.
    CLEAR s_func.
    MOVE-CORRESPONDING &lt;fu&gt; TO s_func-hdr.
    s_func-texts = get_func_texts( texts = fm_data-texts
                                obj_code = s_func-code
                                sub_code = s_func-textno ).
    INSERT s_func INTO TABLE functions.
  ENDLOOP.

  t_tmp_m = fm_data-menus.
  SORT t_tmp_m                                   BY code.
  DELETE ADJACENT DUPLICATES FROM t_tmp_m COMPARING code.
  t_menus = t_tmp_m.
* Security Menu bars without name are not in attributes tables.
  LOOP AT fm_data-menus_det ASSIGNING &lt;md&gt;.
    READ TABLE t_menus TRANSPORTING NO FIELDS
         WITH TABLE KEY code = &lt;md&gt;-code.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_mnu.        s_mnu-code = &lt;md&gt;-code.
      INSERT s_mnu INTO TABLE t_menus.
    ENDIF.
  ENDLOOP.
  LOOP AT t_menus ASSIGNING &lt;mn&gt;.
    CLEAR s_menu.
    MOVE-CORRESPONDING &lt;mn&gt; TO s_menu-hdr.
    s_menu-texts = get_texts( texts = fm_data-texts
                           obj_type = obj_types-menu
                           obj_code = s_menu-code
                           sub_code = space
                           texttype = text_types-object ).
    LOOP AT fm_data-menus_det ASSIGNING &lt;md&gt;
            WHERE code = &lt;mn&gt;-code.
      CLEAR s_m_det.
      MOVE-CORRESPONDING &lt;md&gt; TO s_m_det.
      CLEAR: s_m_det-code.
      INSERT s_m_det INTO TABLE s_menu-composition.
    ENDLOOP.
    INSERT s_menu INTO TABLE menu_list.
  ENDLOOP.

  t_tmp = fm_data-attributes.
  SORT t_tmp                                   BY obj_code sub_code obj_type.
  DELETE ADJACENT DUPLICATES FROM t_tmp COMPARING obj_code sub_code obj_type.
  t_attr = t_tmp.
* Security Menu bars without name are not in attributes tables.
  LOOP AT fm_data-bars_det ASSIGNING &lt;bd&gt;.
    READ TABLE t_attr TRANSPORTING NO FIELDS
         WITH TABLE KEY obj_code = &lt;bd&gt;-code
                        sub_code = space
                        obj_type = obj_types-menu_bar.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_attr.        s_attr-obj_type = obj_types-menu_bar.         s_attr-obj_code = &lt;bd&gt;-code.
      INSERT s_attr INTO TABLE t_attr.
    ENDIF.
  ENDLOOP.
* Security keyboars without name are not in attributes tables.
  LOOP AT fm_data-keyboards ASSIGNING &lt;kb&gt;.
    READ TABLE t_attr TRANSPORTING NO FIELDS
         WITH TABLE KEY obj_code = &lt;kb&gt;-code
                        sub_code = space
                        obj_type = obj_types-key_set.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_attr.        s_attr-obj_type = obj_types-key_set.         s_attr-obj_code = &lt;kb&gt;-code.
      INSERT s_attr INTO TABLE t_attr.
    ENDIF.
  ENDLOOP.
* Security button without name are not in attributes tables.
  LOOP AT fm_data-buttons_det ASSIGNING &lt;bu&gt;.
    READ TABLE t_attr TRANSPORTING NO FIELDS
         WITH TABLE KEY obj_code = &lt;bu&gt;-pfk_code
                        sub_code = &lt;bu&gt;-code
                        obj_type = obj_types-button.
    IF sy-subrc &lt;&gt; 0.
      CLEAR s_attr.        s_attr-obj_type = obj_types-button.         s_attr-obj_code = &lt;bu&gt;-pfk_code.     s_attr-sub_code = &lt;bu&gt;-code.
      INSERT s_attr INTO TABLE t_attr.
    ENDIF.
  ENDLOOP.

  LOOP AT t_attr ASSIGNING &lt;at&gt;.
    CASE &lt;at&gt;-obj_type.
      WHEN obj_types-menu_bar.
        CLEAR s_bar.        MOVE-CORRESPONDING &lt;at&gt; TO s_bar-hdr.
        s_bar-texts = get_texts( texts = fm_data-texts
                              obj_type = obj_types-menu_bar
                              obj_code = s_bar-obj_code
                              sub_code = space
                              texttype = text_types-tech_info ).
        LOOP AT fm_data-bars_det ASSIGNING &lt;bd&gt;
                WHERE code = &lt;at&gt;-obj_code.
          CLEAR s_b_det.        MOVE-CORRESPONDING &lt;bd&gt; TO s_b_det.         CLEAR: s_b_det-code.
          INSERT s_b_det INTO TABLE s_bar-composition.
        ENDLOOP.
        CLEAR s_bar-obj_type.
        INSERT s_bar INTO TABLE menu_bars.
      WHEN obj_types-key_set.
        CLEAR s_key.          MOVE-CORRESPONDING &lt;at&gt; TO s_key-hdr.
        s_key-texts = get_texts( texts = fm_data-texts
                              obj_type = obj_types-key_set
                              obj_code = s_key-obj_code
                              sub_code = space
                              texttype = text_types-tech_info ).
        LOOP AT fm_data-keyboards ASSIGNING &lt;kb&gt;
                WHERE code = &lt;at&gt;-obj_code.
          CLEAR s_k_det.          MOVE-CORRESPONDING &lt;kb&gt; TO s_k_det.       CLEAR: s_k_det-code.
          INSERT s_k_det INTO TABLE s_key-keys.
        ENDLOOP.
        CLEAR s_key-obj_type.
        INSERT s_key INTO TABLE key_settings.
      WHEN obj_types-button.
        READ TABLE key_settings ASSIGNING &lt;k&gt;
             WITH TABLE KEY obj_code = &lt;at&gt;-obj_code.
        IF sy-subrc &lt;&gt; 0.
          WRITE:/ &apos;button without key&apos;, &lt;at&gt;-obj_code.
        ELSE.
          CLEAR s_but.        MOVE-CORRESPONDING &lt;at&gt; TO s_but-hdr.
          s_but-texts = get_texts( texts = fm_data-texts
                                obj_type = obj_types-button
                                obj_code = s_but-obj_code
                                sub_code = s_but-sub_code
                                texttype = text_types-tech_info ).
          LOOP AT fm_data-buttons_det ASSIGNING &lt;bu&gt;
                  WHERE pfk_code = &lt;at&gt;-obj_code
                    AND code = &lt;at&gt;-sub_code.
            CLEAR s_u_det.        MOVE-CORRESPONDING &lt;bu&gt; TO s_u_det.       CLEAR: s_u_det-pfk_code, s_u_det-code.
            INSERT s_u_det INTO TABLE s_but-composition.
          ENDLOOP.
          CLEAR: s_but-obj_type, s_but-obj_code.
          INSERT s_but INTO TABLE &lt;k&gt;-pushbuttons.
        ENDIF.
    ENDCASE.
  ENDLOOP.

  LOOP AT fm_data-status ASSIGNING &lt;st&gt;.
    CLEAR s_statu.     MOVE-CORRESPONDING &lt;st&gt; TO s_statu-hdr.
    s_statu-texts = get_texts( texts = fm_data-texts
                            obj_type = obj_types-status
                            obj_code = s_statu-code
                            sub_code = space
                            texttype = text_types-tech_info ).
    LOOP AT fm_data-stat_funcs ASSIGNING &lt;sf&gt;
            WHERE status = &lt;st&gt;-code.
      s_s_fu = &lt;sf&gt;-function.
      INSERT s_s_fu INTO TABLE s_statu-functions.
    ENDLOOP.
    INSERT s_statu INTO TABLE status.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="GET_FUNC_TEXTS" VERSION="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Get Function texts"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="OBJ_CODE" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-OBJ_CODE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Function code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_MP_FTEXTS"/>
      <ITEM SCONAME="SUB_CODE" VERSION="1" CMPTYPE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="CLIKE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter. Function key code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="TEXTS" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_STEXTS"/>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;r&gt; LIKE LINE OF result,
    &lt;t&gt; LIKE LINE OF texts.

  LOOP AT texts ASSIGNING &lt;t&gt;
       WHERE obj_type = obj_types-function
         AND obj_code = obj_code
         AND sub_code = sub_code.
    READ TABLE result ASSIGNING &lt;r&gt;
         WITH TABLE KEY langu = &lt;t&gt;-sprsl.
    IF sy-subrc &lt;&gt; 0.
      s_txt-langu = &lt;t&gt;-sprsl.
      INSERT s_txt INTO TABLE result.
      READ TABLE result ASSIGNING &lt;r&gt;
           WITH TABLE KEY langu = &lt;t&gt;-sprsl.
      IF sy-subrc &lt;&gt; 0.
* Not possible ==&gt; will dump
      ENDIF.
    ENDIF.

    CASE &lt;t&gt;-texttype.
      WHEN text_types-object.
        &lt;r&gt;-text = &lt;t&gt;-text.
      WHEN text_types-icon.
        &lt;r&gt;-icon = &lt;t&gt;-text.
      WHEN text_types-quick_info.
        &lt;r&gt;-info = &lt;t&gt;-text.
      WHEN OTHERS.
* Erro handling
    ENDCASE.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="GET_TEXTS" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Get texts for Object_type"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="OBJ_CODE" VERSION="1" CMPTYPE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-OBJ_CODE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Function code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="OBJ_TYPE" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-OBJ_TYPE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Standards maintenance: Object type"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_MP_TEXTS"/>
      <ITEM SCONAME="SUB_CODE" VERSION="1" CMPTYPE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="CLIKE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter. Function key code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="TEXTS" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_STEXTS"/>
      <ITEM SCONAME="TEXTTYPE" VERSION="1" CMPTYPE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-TEXTTYPE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Text type"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.

  LOOP AT texts ASSIGNING &lt;t&gt;
       WHERE obj_type = obj_type
         AND obj_code = obj_code
         AND sub_code = sub_code
         AND texttype = texttype.
    s_txt-langu = &lt;t&gt;-sprsl.
    s_txt-text = &lt;t&gt;-text.
    INSERT s_txt INTO TABLE result.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="SET_FUNC_TEXTS" VERSION="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Set Function texts"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="OBJ_CODE" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-OBJ_CODE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Function code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_STEXTS"/>
      <ITEM SCONAME="SUB_CODE" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="CLIKE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter. Function key code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="TEXTS" VERSION="1" CMPTYPE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_MP_FTEXTS"/>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.

  LOOP AT texts ASSIGNING &lt;t&gt;.
    clear s_txt.
    s_txt-obj_type = obj_types-function.
    s_txt-obj_code = obj_code.
    s_txt-sub_code = sub_code.
    s_txt-sprsl = &lt;t&gt;-langu.
    s_txt-texttype = text_types-object.     s_txt-text = &lt;t&gt;-text.      if not s_txt-text is INITIAL. INSERT s_txt INTO TABLE result. endif.
    s_txt-texttype = text_types-icon.       s_txt-text = &lt;t&gt;-icon.      if not s_txt-text is INITIAL. INSERT s_txt INTO TABLE result. endif.
    s_txt-texttype = text_types-quick_info. s_txt-text = &lt;t&gt;-info.      if not s_txt-text is INITIAL. INSERT s_txt INTO TABLE result. endif.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="SET_TEXTS" VERSION="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Set texts from texts data"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="OBJ_CODE" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-OBJ_CODE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Function code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="OBJ_TYPE" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-OBJ_TYPE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Standards maintenance: Object type"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="2" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_STEXTS"/>
      <ITEM SCONAME="SUB_CODE" VERSION="1" CMPTYPE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="CLIKE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter. Function key code"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="TEXTS" VERSION="1" CMPTYPE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_MP_TEXTS"/>
      <ITEM SCONAME="TEXTTYPE" VERSION="1" CMPTYPE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="RSMPTEXTS-TEXTTYPE">
       <TEXTS>
        <ITEM LANG="E" TEXT="Menu Painter: Text type"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt LIKE LINE OF result.
  FIELD-SYMBOLS:
    &lt;t&gt; LIKE LINE OF texts.

  LOOP AT texts ASSIGNING &lt;t&gt;.
    s_txt-obj_type = obj_type.
    s_txt-obj_code = obj_code.
    s_txt-sub_code = sub_code.
    s_txt-texttype = texttype.
    s_txt-sprsl = &lt;t&gt;-langu.
    s_txt-text = &lt;t&gt;-text.
    INSERT s_txt INTO TABLE result.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="TO_DATA" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert object attributes to FM Data"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Modules object Data"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="PROGRAM" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROGNAME"/>
     </PARAMETERS>
     <SOURCE>`
  DATA s_title LIKE LINE OF fm_data-titles.
  DATA s_func  LIKE LINE OF fm_data-functions.
  DATA s_statu LIKE LINE OF fm_data-status.
  DATA s_s_fu  LIKE LINE OF fm_data-stat_funcs.
  DATA s_menu  LIKE LINE OF fm_data-menus.
  DATA s_m_det LIKE LINE OF fm_data-menus_det.
  DATA s_attr  LIKE LINE OF fm_data-attributes.
  DATA s_b_det LIKE LINE OF fm_data-bars_det.
  DATA s_k_det LIKE LINE OF fm_data-keyboards.
  DATA s_but   LIKE LINE OF fm_data-buttons_det.
  DATA s_text  LIKE LINE OF fm_data-texts.
  DATA d_lang  TYPE sy-langu.
  FIELD-SYMBOLS:
    &lt;mb&gt; LIKE LINE OF menu_bars,
    &lt;bc&gt; LIKE LINE OF &lt;mb&gt;-composition,
    &lt;ks&gt; LIKE LINE OF key_settings,
    &lt;kk&gt; LIKE LINE OF &lt;ks&gt;-keys,
    &lt;pb&gt; LIKE LINE OF &lt;ks&gt;-pushbuttons,
    &lt;pc&gt; LIKE LINE OF &lt;pb&gt;-composition,
    &lt;st&gt; LIKE LINE OF status,
    &lt;sf&gt; LIKE LINE OF &lt;st&gt;-functions,
    &lt;mn&gt; LIKE LINE OF menu_list,
    &lt;md&gt; LIKE LINE OF &lt;mn&gt;-composition,
    &lt;fu&gt; LIKE LINE OF functions,
    &lt;ti&gt; LIKE LINE OF titles,
    &lt;tl&gt; LIKE LINE OF &lt;fu&gt;-texts,
    &lt;t&gt;  LIKE LINE OF &lt;st&gt;-texts.

  fm_data-header-actcode = bar.
  fm_data-header-mencode = menu.
  fm_data-header-pfkcode = function.
  fm_data-header-defaultact = default_bar.
  fm_data-header-defaultpfk = default_function.
  fm_data-header-mod_langu = d_lang = master_lang.
  IF d_lang IS INITIAL.  d_lang = sy-langu.    ENDIF.

  LOOP AT titles ASSIGNING &lt;ti&gt;.
    CLEAR s_title.        MOVE-CORRESPONDING &lt;ti&gt;-hdr TO s_title.
    INSERT s_title INTO TABLE fm_data-titles.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-title
        obj_code = s_title-code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;ti&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
  ENDLOOP.

  LOOP AT functions ASSIGNING &lt;fu&gt;.
    CLEAR s_func.     MOVE-CORRESPONDING &lt;fu&gt;-hdr TO s_func.
    READ TABLE &lt;fu&gt;-texts ASSIGNING &lt;tl&gt; WITH TABLE KEY langu = d_lang.
    IF sy-subrc = 0.    s_func-fun_text = &lt;tl&gt;-text.  s_func-icon_text = &lt;tl&gt;-icon.  s_func-info_text = &lt;tl&gt;-info.  ENDIF.    &quot; Issue 116

    INSERT s_func INTO TABLE fm_data-functions.
    CALL METHOD set_func_texts
      EXPORTING
        obj_code = s_func-code
        sub_code = s_func-textno
        texts    = &lt;fu&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
  ENDLOOP.

  LOOP AT menu_list ASSIGNING &lt;mn&gt;.
    CLEAR s_menu.     MOVE-CORRESPONDING &lt;mn&gt;-hdr TO s_menu.
    INSERT s_menu INTO TABLE fm_data-menus.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-menu
        obj_code = s_menu-code
        sub_code = space
        texttype = text_types-object
        texts    = &lt;mn&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;mn&gt;-composition ASSIGNING &lt;md&gt;.
      CLEAR s_m_det.      MOVE-CORRESPONDING &lt;md&gt; TO s_m_det.       s_m_det-code = &lt;mn&gt;-code.
      INSERT s_m_det INTO TABLE fm_data-menus_det.
    ENDLOOP.
  ENDLOOP.

* Menu Bars
  LOOP AT menu_bars ASSIGNING &lt;mb&gt;.
    CLEAR s_attr.         MOVE-CORRESPONDING &lt;mb&gt;-hdr TO s_attr.    s_attr-obj_type = obj_types-menu_bar.
    READ TABLE &lt;mb&gt;-texts ASSIGNING &lt;t&gt; WITH TABLE KEY langu = d_lang.
    IF sy-subrc = 0.    s_attr-int_note = &lt;t&gt;-text.  ENDIF.
    INSERT s_attr INTO TABLE fm_data-attributes.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-menu_bar
        obj_code = s_attr-obj_code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;mb&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;mb&gt;-composition ASSIGNING &lt;bc&gt;.
      CLEAR s_b_det.      MOVE-CORRESPONDING &lt;bc&gt; TO s_b_det.       s_b_det-code = &lt;mb&gt;-obj_code.
      INSERT s_b_det INTO TABLE fm_data-bars_det.
    ENDLOOP.
  ENDLOOP.

* Key settings
  LOOP AT key_settings ASSIGNING &lt;ks&gt;.
    CLEAR s_attr.         MOVE-CORRESPONDING &lt;ks&gt;-hdr TO s_attr.    s_attr-obj_type = obj_types-key_set.
    READ TABLE &lt;ks&gt;-texts ASSIGNING &lt;t&gt; WITH TABLE KEY langu = d_lang.
    IF sy-subrc = 0.    s_attr-int_note = &lt;t&gt;-text.  ENDIF.
    INSERT s_attr INTO TABLE fm_data-attributes.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-key_set
        obj_code = s_attr-obj_code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;ks&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;ks&gt;-keys ASSIGNING &lt;kk&gt;.
      CLEAR s_k_det.      MOVE-CORRESPONDING &lt;kk&gt; TO s_k_det.       s_k_det-code = &lt;ks&gt;-obj_code.
      INSERT s_k_det INTO TABLE fm_data-keyboards.
    ENDLOOP.
    LOOP AT &lt;ks&gt;-pushbuttons ASSIGNING &lt;pb&gt;.
      CLEAR s_attr.       MOVE-CORRESPONDING &lt;pb&gt; TO s_attr.        s_attr-obj_type = obj_types-button.       s_attr-obj_code = &lt;ks&gt;-obj_code.
      READ TABLE &lt;pb&gt;-texts ASSIGNING &lt;t&gt; WITH TABLE KEY langu = d_lang.
      IF sy-subrc = 0.    s_attr-int_note = &lt;t&gt;-text.  ENDIF.
      INSERT s_attr INTO TABLE fm_data-attributes.
      CALL METHOD set_texts
        EXPORTING
          obj_type = obj_types-button
          obj_code = s_attr-obj_code
          sub_code = s_attr-sub_code
          texttype = text_types-tech_info
          texts    = &lt;pb&gt;-texts
        CHANGING
          RESULT   = fm_data-texts.
      LOOP AT &lt;pb&gt;-composition ASSIGNING &lt;pc&gt;.
        CLEAR s_but.      MOVE-CORRESPONDING &lt;pc&gt; TO s_but.         s_but-pfk_code = &lt;ks&gt;-obj_code.        s_but-code = &lt;pb&gt;-sub_code.
        INSERT s_but INTO TABLE fm_data-buttons_det.
      ENDLOOP.
    ENDLOOP.
  ENDLOOP.

  LOOP AT status ASSIGNING &lt;st&gt;.
    CLEAR s_statu.        MOVE-CORRESPONDING &lt;st&gt;-hdr TO s_statu.
    READ TABLE &lt;st&gt;-texts ASSIGNING &lt;t&gt; WITH TABLE KEY langu = d_lang.
    IF sy-subrc = 0.    s_statu-int_note = &lt;t&gt;-text.  ENDIF.
    INSERT s_statu INTO TABLE fm_data-status.
    CALL METHOD set_texts
      EXPORTING
        obj_type = obj_types-status
        obj_code = s_statu-code
        sub_code = space
        texttype = text_types-tech_info
        texts    = &lt;st&gt;-texts
      CHANGING
        RESULT   = fm_data-texts.
    LOOP AT &lt;st&gt;-functions ASSIGNING &lt;sf&gt;.
      CLEAR s_s_fu.     s_s_fu-status = &lt;st&gt;-code.      s_s_fu-function = &lt;sf&gt;.
      INSERT s_s_fu INTO TABLE fm_data-stat_funcs.
    ENDLOOP.
  ENDLOOP.

  s_text-progname = program.
  MODIFY fm_data-texts FROM s_text TRANSPORTING progname WHERE progname &lt;&gt; program.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="UNANONYMIZE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="UnAnonymized component data"/>
     </TEXTS>
    </ITEM>
   </METHODS>
   <TYPES>
    <ITEM CMPNAME="TS_ATTRIBUTE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="22 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_attribute.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts TYPE tt_mp_texts,
      END OF ts_attribute
`</ITEM>
    <ITEM CMPNAME="TS_BAR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="14 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_bar.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        composition  TYPE tt_bar_details,
      END OF ts_bar
`</ITEM>
    <ITEM CMPNAME="TS_BUTTON" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="17 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_button.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        composition  TYPE tt_button_details,
      END OF ts_button
`</ITEM>
    <ITEM CMPNAME="TS_FM_DATA" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="39 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_fm_data,
          header        TYPE rsmpe_adm,
          status        TYPE tt_stat,
          functions     TYPE tt_funt,
          menus_det     TYPE tt_men,
          menus         TYPE tt_mnlt,
          bars_det      TYPE tt_act,
          buttons_det   TYPE tt_but,
          keyboards     TYPE tt_pfk,
          stat_funcs    TYPE tt_staf,
          attributes    TYPE tt_atrt,
          titles        TYPE tt_titt,
          ffuncs        TYPE tt_buts,
          texts         TYPE tt_stexts,
        END OF ts_fm_data
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Function Module Data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_FUNCTION" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_function.
    INCLUDE TYPE rsmpe_fun AS hdr.
    TYPES:
        texts         TYPE tt_mp_ftexts,
      END OF ts_function
`</ITEM>
    <ITEM CMPNAME="TS_KEYBOARD" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="20 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_keyboard.
    INCLUDE TYPE rsmpe_atr AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        keys         TYPE tt_keyssettings,
        pushbuttons  TYPE tt_buttons,
      END OF ts_keyboard
`</ITEM>
    <ITEM CMPNAME="TS_MENU" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="11 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_menu.
    INCLUDE TYPE rsmpe_mnl AS hdr.
    TYPES:
        texts        TYPE tt_mp_texts,
        composition  TYPE tt_menu_details,
      END OF ts_menu
`</ITEM>
    <ITEM CMPNAME="TS_MP_FTEXT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_mp_ftext,
          langu TYPE rsmptexts-sprsl,
          text  TYPE rsmptexts-text,
          icon  TYPE rsmptexts-text,
          info  TYPE rsmptexts-text,
        END OF ts_mp_ftext
`</ITEM>
    <ITEM CMPNAME="TS_MP_TEXT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_mp_text,
          langu TYPE rsmptexts-sprsl,
          text  TYPE rsmptexts-text,
*    types:
*      begin of ts_menu.
*        include TYPE rsmpe_mnl as hdr.
*    types:
*        texts type tt_mp_texts,
*      end of ts_menu.
*    TYPES:
*      tt_mtexts TYPE STANDARD TABLE OF t WITH unique KEY code .
        END OF ts_mp_text
`</ITEM>
    <ITEM CMPNAME="TS_STATUS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_status.
    INCLUDE TYPE rsmpe_sta AS hdr.
    TYPES:
        texts TYPE tt_mp_texts,
        functions TYPE tt_funcs,
      END OF ts_status
`</ITEM>
    <ITEM CMPNAME="TS_TITLE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="24 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_title.
    INCLUDE TYPE rsmpe_tit AS hdr.
    TYPES:
        texts TYPE tt_mp_texts,
      END OF ts_title
`</ITEM>
    <ITEM CMPNAME="TT_ACT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="31 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_act TYPE STANDARD TABLE OF rsmpe_act WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_ATRT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="35 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_atrt TYPE STANDARD TABLE OF rsmpe_atrt WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_ATTRIBUTES" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="23 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_attributes TYPE SORTED TABLE OF ts_attribute WITH UNIQUE KEY obj_type obj_code sub_code
`</ITEM>
    <ITEM CMPNAME="TT_BARS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="15 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_bars TYPE SORTED TABLE OF ts_bar WITH UNIQUE KEY obj_code
`</ITEM>
    <ITEM CMPNAME="TT_BAR_DETAILS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="13 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_bar_details TYPE SORTED TABLE OF rsmpe_act WITH UNIQUE KEY no
`</ITEM>
    <ITEM CMPNAME="TT_BUT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="32 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_but TYPE STANDARD TABLE OF rsmpe_but WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_BUTS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="37 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_buts TYPE STANDARD TABLE OF rsmpe_buts WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_BUTTONS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="18 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_buttons TYPE SORTED TABLE OF ts_button WITH UNIQUE KEY sub_code
`</ITEM>
    <ITEM CMPNAME="TT_BUTTON_DETAILS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="16 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_button_details TYPE SORTED TABLE OF rsmpe_but WITH UNIQUE KEY no
`</ITEM>
    <ITEM CMPNAME="TT_FFUNCS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="26 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_ffuncs TYPE SORTED TABLE OF rsmpe_buts WITH UNIQUE KEY obj_code sub_code
`</ITEM>
    <ITEM CMPNAME="TT_FUNCS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_funcs TYPE SORTED TABLE OF gui_func WITH UNIQUE KEY table_line
`</ITEM>
    <ITEM CMPNAME="TT_FUNCTIONS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="9 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_functions TYPE SORTED TABLE OF ts_function WITH UNIQUE KEY code textno
`</ITEM>
    <ITEM CMPNAME="TT_FUNT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="28 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_funt TYPE STANDARD TABLE OF rsmpe_funt WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_KEYBOARDS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="21 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_keyboards TYPE SORTED TABLE OF ts_keyboard WITH UNIQUE KEY obj_code
`</ITEM>
    <ITEM CMPNAME="TT_KEYSSETTINGS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="19 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_keyssettings TYPE SORTED TABLE OF rsmpe_pfk WITH UNIQUE KEY pfno
`</ITEM>
    <ITEM CMPNAME="TT_MEN" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="29 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_men TYPE STANDARD TABLE OF rsmpe_men WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_MENUS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="12 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_menus TYPE SORTED TABLE OF ts_menu WITH UNIQUE KEY code
`</ITEM>
    <ITEM CMPNAME="TT_MENU_DETAILS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="10 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_menu_details TYPE SORTED TABLE OF rsmpe_men WITH UNIQUE KEY no
`</ITEM>
    <ITEM CMPNAME="TT_MNLT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="30 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_mnlt TYPE STANDARD TABLE OF rsmpe_mnlt WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_MP_FTEXTS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_mp_ftexts TYPE SORTED TABLE OF ts_mp_ftext WITH UNIQUE KEY langu
`</ITEM>
    <ITEM CMPNAME="TT_MP_TEXTS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_mp_texts TYPE SORTED TABLE OF ts_mp_text WITH UNIQUE KEY langu
`</ITEM>
    <ITEM CMPNAME="TT_PFK" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="33 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_pfk TYPE STANDARD TABLE OF rsmpe_pfk WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_STAF" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="34 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_staf TYPE STANDARD TABLE OF rsmpe_staf WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_STAT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="27 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_stat TYPE STANDARD TABLE OF rsmpe_stat WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_STATUS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_status TYPE SORTED TABLE OF ts_status WITH UNIQUE KEY code
`</ITEM>
    <ITEM CMPNAME="TT_STEXTS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="38 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_stexts TYPE SORTED TABLE OF rsmptexts WITH UNIQUE KEY obj_type obj_code sub_code texttype sprsl
`</ITEM>
    <ITEM CMPNAME="TT_TITLES" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="25 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_titles TYPE SORTED TABLE OF ts_title WITH UNIQUE KEY code
`</ITEM>
    <ITEM CMPNAME="TT_TITT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="36 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_titt TYPE STANDARD TABLE OF rsmpe_titt WITH DEFAULT KEY
`</ITEM>
   </TYPES>
  </RAW>
 </ZL_OBJECT>
 <ZL_OBJECT CHECKSUM="9793BD0D81490078DD5FB29FFB1ACC57" CODE_SIGNATURE="C74935E7093DAB3294734DF130128D99" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_PROGRAM" TYPE="CLAS" VERSION="1.01">
  <DEPENDENCIES>
   <ITEM TYPE="CLAS" NAME="ZAPLINK_CONNECTOR_"/>
  </DEPENDENCIES>
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20090703" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="701" MSG_ID="ZAPLINK_PROGRAM">
    <INHERITANCE REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <TEXTS>
     <ITEM LANG="E" TEXT="Data for Class">U1&amp;FUNCTIONALITY&amp;
ASConnector for :
AS,,- PROG : ABAP Program
U1&amp;RELATIONS&amp;
ASIs part of ZAP Link Framework as Official Connector.
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AShttps://code.google.com/p/zaplink/wiki/Connector
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
    </TEXTS>
   </A0_MAINDATA>
   <ATTRIBUTS>
    <ITEM CMPNAME="BALLOG_SUBOBJECT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="2" ATTVALUE="&apos;CNX_PROGRAM&apos;" TYPTYPE="1" TYPE="BALSUBOBJ" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Application Log: Subobject"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="CURRENT_PARAM" VERSION="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_VARI_DATA=&gt;TS_PARAM_DATA" R3RELEASE="701"/>
    <ITEM CMPNAME="FLAGS" VERSION="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF flags,       &quot; include RSDBCOM2
      BEGIN OF varid,
        noimp TYPE x VALUE &apos;10&apos;,
        imp TYPE x VALUE &apos;EF&apos;,
        allscreens TYPE x VALUE &apos;20&apos;,
        not_all_screens TYPE x VALUE &apos;20&apos;,
        screens TYPE x VALUE &apos;DF&apos;,
      END OF varid,
      BEGIN OF vari,
        nospagpa TYPE x VALUE &apos;40&apos;,
        spagpa TYPE x VALUE &apos;BF&apos;,
        noint  TYPE x VALUE &apos;80&apos;,
        obli   TYPE x VALUE &apos;01&apos;,
        int TYPE x VALUE &apos;7F&apos;,
        no_obli TYPE x VALUE &apos;FE&apos;,
      END OF vari,
    END OF flags
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Mask values for XFLAG in VARI and VARID"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="REPORT" VERSION="1" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="1" TYPTYPE="1" TYPE="SY-REPID" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Program for form"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="R_DOC_ID" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="1" TYPTYPE="1" TYPE="TR_DOCID" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Documentation Object"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="SUPPORTEDTYPES" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">BEGIN OF supportedtypes,
      program          TYPE td_comptype VALUE &apos;PROG&apos;,       &quot;#EC NOTEXT
      sys_variant      TYPE td_comptype VALUE &apos;VARI&apos;,       &quot;#EC NOTEXT
      appl_variant     TYPE td_comptype VALUE &apos;VARX&apos;,       &quot;#EC NOTEXT
    END OF supportedtypes
`</ITEM>
    <ITEM CMPNAME="_UUID" VERSION="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="2" ATTVALUE="&apos;AAAD0A4B07A5A05AE1000000AC120173&apos;" TYPTYPE="1" TYPE="TD_CONNUUID" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="UUID for connector Program"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="_VER" VERSION="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="2" ATTVALUE="&apos;1.0&apos;" TYPTYPE="1" TYPE="TD_CONNVER" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Connector Version"/>
     </TEXTS>
    </ITEM>
   </ATTRIBUTS>
   <FRIENDS>
    <ITEM REFCLSNAME="ZAPLINK_PROG_DATA" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <ITEM REFCLSNAME="ZAPLINK_VARI_DATA" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <ITEM REFCLSNAME="ZAPLINK_VARI_RAW" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
   </FRIENDS>
   <LOCAL>
    <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
    <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
    <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* in the implementation part of the class

INCLUDE zaplink_macros.</MACROS>
   </LOCAL>
   <METHODS>
    <ITEM CMPNAME="CLASS_CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDTYPE="2" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="CLASS_CONSTRUCTOR"/>
     </TEXTS>
     <SOURCE>`
*table TDCLT
*DOKCLASS DOKTITEL
*CF       Program function                                             Program              Function
*CM       Pull-down menu/menu bar                                      Program              Menu
*RE       Report/Function Group, Logical DB                            Program/module pool
  DATA _id    LIKE LINE OF r_doc_id.
  DATA f_ok   TYPE abap_bool.

  _id-sign = &apos;I&apos;.
  _id-option = &apos;EQ&apos;.
  _id-low = &apos;CF&apos;. APPEND _id TO r_doc_id.
  _id-low = &apos;CM&apos;. APPEND _id TO r_doc_id.
  _id-low = &apos;RE&apos;. APPEND _id TO r_doc_id.

  PERFORM check_vari_form_exists IN PROGRAM (sy-repid) CHANGING f_ok IF FOUND.
  IF NOT f_ok IS INITIAL.   report = sy-repid.    RETURN.   ENDIF.
  PERFORM check_vari_form_exists IN PROGRAM zaplink_vari CHANGING f_ok IF FOUND.
  IF NOT f_ok IS INITIAL.
    report = &apos;ZAPLINK_VARI&apos;.    &quot; Dump if program name is in lower case
  ENDIF.
*      assert ID ZAPLINK CONDITION f_ok is initial.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDTYPE="2" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="CONSTRUCTOR"/>
     </TEXTS>
     <SOURCE>`
  DATA type LIKE LINE OF supported_types.

  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.    application_log-&gt;msgid = &apos;ZAPLINK_PROGRAM&apos;.
  type-type = supportedtypes-program. INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-sys_variant. INSERT type INTO TABLE supported_types.
  type-type = supportedtypes-appl_variant. INSERT type INTO TABLE supported_types.

  uuid = _uuid.
  version = _ver.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="GET_PARAM_VALUE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Return Param value from subroutine pool"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="VALUE" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="STRING"/>
     </PARAMETERS>
     <SOURCE>`
  current_param-value = value.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="GET_PROGRAM_SIGNATURE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Get Source code Signature of a program"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="PROGRAM_NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROGNAME">
       <TEXTS>
        <ITEM LANG="E" TEXT="Program Name"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="ZAPLINK_DATATYPES~TD_CHECKSUM">
       <TEXTS>
        <ITEM LANG="E" TEXT="MD5 Hash"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA t_code TYPE tt_abaprawsource.
  DATA d_src  TYPE string.

  t_code = get_prog_rawsource( program_name ).
  zaplink_tools=&gt;pretty_printer( CHANGING table = t_code ).
  zaplink_tools=&gt;condense_abap_source( CHANGING table = t_code ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).</SOURCE>
    </ITEM>
    <ITEM CMPNAME="GET_SELECTOPTION_VALUE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="9 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Return Select options value form subroutine pool"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="VALUE" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="ANY TABLE"/>
     </PARAMETERS>
     <SOURCE>`
  DATA my_value LIKE LINE OF current_param-values.
*  DATA _desc    TYPE REF TO cl_abap_structdescr.
  FIELD-SYMBOLS:
*    &lt;c&gt; LIKE LINE OF _desc-&gt;components,
*    &lt;sf&gt; TYPE ANY,
*    &lt;tf&gt; TYPE ANY,
    &lt;v&gt; TYPE ANY.

  CHECK NOT value[] IS INITIAL.
*  LOOP AT value ASSIGNING &lt;v&gt;.   EXIT.   ENDLOOP.
*  _desc ?= cl_abap_structdescr=&gt;describe_by_data( p_data = &lt;v&gt; ).
  LOOP AT value ASSIGNING &lt;v&gt;.
    CLEAR my_value.
    MOVE-CORRESPONDING &lt;v&gt; to my_value.
*    LOOP AT _desc-&gt;components ASSIGNING &lt;c&gt;.
*      UNASSIGN: &lt;sf&gt;, &lt;tf&gt;.
*      ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE &lt;v&gt; TO &lt;sf&gt;.
*      ASSIGN COMPONENT &lt;c&gt;-name OF STRUCTURE my_value TO &lt;tf&gt;.
*      &lt;tf&gt; = &lt;sf&gt;.
*    ENDLOOP.
    APPEND my_value TO current_param-values.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="GET_VARIANT_PARAMS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Get Variant parameters"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="PROGRAM" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROGNAME"/>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_VARIANT_DATA"/>
      <ITEM SCONAME="VARIANT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_VARIANT">
       <TEXTS>
        <ITEM LANG="E" TEXT="ABAP: Name of variant (without program name)"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA p_key     TYPE rsvarkey.
  DATA t_screens TYPE STANDARD TABLE OF rsscr.
  DATA t_vari    TYPE STANDARD TABLE OF rvari.
  DATA p_subrc   TYPE sy-subrc.
  DATA p_subrc_s TYPE sy-subrc.
  DATA s_subrc   TYPE string.
  DATA s_subrc_s TYPE string.
  DATA d_param   LIKE LINE OF current_param-params.
  DATA d_mandt   TYPE sy-mandt.
  TYPES tt_vdat TYPE STANDARD TABLE OF rsvarivdat.
  TYPES tt_vdyn TYPE STANDARD TABLE OF rsvaridyn.
  TYPES tt_vdd  TYPE STANDARD TABLE OF rsvdatdyn.
  FIELD-SYMBOLS:
    &lt;vdat&gt; TYPE tt_vdat,
    &lt;vdyn&gt; TYPE tt_vdyn,
    &lt;vdd&gt;  TYPE tt_vdd,
    &lt;dat&gt;  LIKE LINE OF &lt;vdat&gt;,
    &lt;s&gt; LIKE LINE OF t_screens,
    &lt;v&gt; LIKE LINE OF t_vari.
  DATA: BEGIN OF l_formname_0,
          prefix(7) VALUE &apos;%_LINK_&apos;,
          suffix(8),
        END OF l_formname_0.

  DATA d_formname TYPE string.

  p_key-report = program.
  p_key-variant = variant.
  PERFORM import_var_selc IN PROGRAM saplsvar TABLES t_screens t_vari
                                               USING p_key-report p_key
                                            CHANGING p_subrc p_subrc_s.
  IF NOT p_subrc_s IS INITIAL.
    IF 1 = 2.   MESSAGE i000 WITH space space space.  ENDIF.
    s_subrc = p_subrc_s.
    CALL METHOD application_log-&gt;add_error
      EXPORTING
*        id_msgid     =
        id_msgno     = &apos;000&apos;
*        id_msgv4     =
        id_msgv1     = s_subrc
        id_msgv2     = p_key-report
        id_msgv3     = p_key-variant.
    RETURN.
  ELSEIF NOT p_subrc IS INITIAL.
    IF 1 = 2.   MESSAGE i001 WITH space space space.  ENDIF.
    s_subrc = p_subrc.
    CALL METHOD application_log-&gt;add_error
      EXPORTING
*        id_msgid     =
        id_msgno     = &apos;001&apos;
*        id_msgv4     =
        id_msgv1     = s_subrc
        id_msgv2     = p_key-report
        id_msgv3     = p_key-variant.
    RETURN.
  ENDIF.

* IN import_var_selc
*VARIVDAT LIKE RSVARIVDAT OCCURS 2
*DATA: VARIDYN LIKE RSVARIDYN OCCURS 10 WITH HEADER LINE.
*DATA: GL_VDATDYN LIKE RSVDATDYN OCCURS 0.
*  PERFORM import_variant_static(rsdbspvd) USING    p_selctab[]
*                                                   l_vari[]
*                                                   varivdat[]
*                                                   varidyn[]
*                                                   varivdat_dyn[]
*                                                   p_key
*                                                   p_imp_subrc.
  ASSIGN (&apos;(SAPLSVAR)varivdat[]&apos;) TO &lt;vdat&gt;.
  ASSIGN (&apos;(SAPLSVAR)varidyn[]&apos;) TO &lt;vdyn&gt;.
  ASSIGN (&apos;(SAPLSVAR)varivdat_dyn[]&apos;) TO &lt;vdd&gt;.

  IF variant CP zaplink_vari_data=&gt;variant_prefix-system OR variant CP zaplink_vari_data=&gt;variant_prefix-customer.    d_mandt = &apos;000&apos;.    ELSE.   d_mandt = sy-mandt.    ENDIF.
  PERFORM %_import_vari_clnt IN PROGRAM (p_key-report)
                             USING p_key p_subrc_s d_mandt
                             CHANGING p_subrc
                             IF FOUND.
  IF NOT p_subrc IS INITIAL OR NOT p_subrc_s IS INITIAL.
    IF 1 = 2.   MESSAGE i002 WITH space space space space.  ENDIF.
    s_subrc = p_subrc.
    s_subrc_s = p_subrc_s.
    CALL METHOD application_log-&gt;add_error
      EXPORTING
*        id_msgid     =
        id_msgno     = &apos;002&apos;
        id_msgv1     = s_subrc_s
        id_msgv2     = s_subrc
        id_msgv3     = p_key-report
        id_msgv4     = p_key-variant.
    RETURN.
  ENDIF.

*  PERFORM set_object IN PROGRAM report USING me IF FOUND.
*  IF 1 = 2.   PERFORM set_object IN PROGRAM zaplink_vari USING me IF FOUND.  ENDIF.
  PERFORM set_object IN PROGRAM zaplink_vari USING me IF FOUND.
*perform brepi(rsdbspva) in MF : RS_VARIANT_CONTENTS
  LOOP AT t_vari ASSIGNING &lt;v&gt;.
    CLEAR current_param.
    MOVE-CORRESPONDING &lt;v&gt; TO current_param.
* FROM FORM FILL_TABLES_PS IN PROGRAM saplsvar:
*    PERFORM FILL_TABLES_PS IN PROGRAM saplsvar  tables current_param-hdr
*                                                 using &lt;v&gt;.
    IF &lt;v&gt;-xflag1 O flags-varid-noimp.      current_param-no_import = abap_true.    ENDIF.
    IF &lt;v&gt;-xflag1 O flags-vari-obli.        current_param-obli = abap_true.         ENDIF.
    IF &lt;v&gt;-xflag1 O flags-vari-noint.       current_param-noint = abap_true.        ENDIF.
    IF &lt;v&gt;-xflag1 Z flags-vari-nospagpa.
      READ TABLE t_screens ASSIGNING &lt;s&gt; WITH KEY name = &lt;v&gt;-name.
      IF sy-subrc = 0 AND &lt;s&gt;-spagpa NE space.    current_param-spagpa = abap_true.   ENDIF.
    ENDIF.
*    IF current_param-name NE space.
*      PERFORM init_text_field TABLES selctab
*                        USING current_param-name
*                        current_param-text &apos;S&apos; rsvar-report.
*    ENDIF.
* end FORM FILL_TABLES_PS IN PROGRAM saplsvar
    MOVE &lt;v&gt;-name TO l_formname_0-suffix.
    CONCATENATE &apos;GET_VAL_&apos; &lt;v&gt;-kind INTO d_formname.
    IF 1 = 2.                                               &quot;#EC *
*      PERFORM get_val_s IN PROGRAM zaplink_vari IF FOUND.   &quot;#EC *
      PERFORM get_val_p IN PROGRAM zaplink_vari USING space space space IF FOUND. &quot;#EC *
    ENDIF.
*    PERFORM (l_formname_0) IN PROGRAM (p_key-report)
*           USING report d_formname p_subrc IF FOUND.
    PERFORM (l_formname_0) IN PROGRAM (p_key-report)
           USING &apos;ZAPLINK_VARI&apos; d_formname p_subrc IF FOUND.
    LOOP AT &lt;vdat&gt; ASSIGNING &lt;dat&gt;
         WHERE selname = &lt;v&gt;-name.
      MOVE-CORRESPONDING &lt;dat&gt; TO d_param.
      APPEND d_param TO current_param-params.
    ENDLOOP.
    IF current_param-no_import = abap_true.   CLEAR: current_param-value, current_param-values, current_param-params.    ENDIF.
    INSERT current_param INTO TABLE result.
  ENDLOOP.
*  PERFORM clear_object IN PROGRAM report USING me IF FOUND.
*  IF 1 = 2.   PERFORM clear_object IN PROGRAM zaplink_vari USING me IF FOUND. ENDIF.
  PERFORM clear_object IN PROGRAM zaplink_vari USING me.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="READ_VARIANTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Read variant from SAP"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_VARIANTS"/>
      <ITEM SCONAME="VARIANTS" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_VARIANT_LIST"/>
     </PARAMETERS>
     <SOURCE>`
*  DATA t_varis     TYPE STANDARD TABLE OF varis WITH DEFAULT KEY.
  DATA t_dynnr     TYPE STANDARD TABLE OF rsdynnr WITH DEFAULT KEY.
  DATA t_varis     TYPE STANDARD TABLE OF rsdynnr WITH DEFAULT KEY.
  DATA t_varit     TYPE STANDARD TABLE OF varit WITH DEFAULT KEY.
  DATA s_vari      LIKE LINE OF result.
  DATA s_varis     LIKE LINE OF t_varis.
  FIELD-SYMBOLS:
    &lt;v&gt; LIKE LINE OF variants,
    &lt;t&gt; LIKE LINE OF t_varit,
    &lt;s&gt; LIKE LINE OF t_varis.

*  SELECT * INTO TABLE t_varis
*    FROM varis CLIENT SPECIFIED
*    FOR ALL ENTRIES IN variants
*    WHERE mandt = variants-mandt
*      AND report = variants-report
*      AND variant = variants-variant.

  SELECT * INTO TABLE t_varit
    FROM varit CLIENT SPECIFIED
    FOR ALL ENTRIES IN variants
    WHERE mandt = variants-mandt
      AND report = variants-report
      AND variant = variants-variant.

  LOOP AT variants ASSIGNING &lt;v&gt;.
    CLEAR s_vari.   s_vari-header = &lt;v&gt;.
    LOOP AT t_varit ASSIGNING &lt;t&gt;
         WHERE mandt = &lt;v&gt;-mandt
          AND report = &lt;v&gt;-report
         AND variant = &lt;v&gt;-variant.
      INSERT &lt;t&gt; INTO TABLE s_vari-texts.
    ENDLOOP.
    CALL FUNCTION &apos;RS_GET_SCREENS_4_1_VARIANT&apos;
      EXPORTING
        program                    = &lt;v&gt;-report
        variant                    = &lt;v&gt;-variant
*     IMPORTING
*       FLAG_1000                  =
*       FLAG_ALL_SCREENS           =
      TABLES
        dynnr                      = t_dynnr
        variscreens                = t_varis
      EXCEPTIONS
        no_screens                 = 1
        variant_not_existent       = 2
        OTHERS                     = 3.
    IF sy-subrc &lt;&gt; 0.
      mac_add_mf_and_raise &apos;RS_GET_SCREENS_4_1_VARIANT&apos; sy-subrc.
    ENDIF.
    DELETE t_varis WHERE dynnr = &apos;*&apos;.   &quot; only one screen
    MODIFY t_varis FROM s_varis TRANSPORTING kind WHERE NOT kind IS INITIAL.    &quot; not used on import
    s_vari-screens = t_varis.
*    LOOP AT t_varis ASSIGNING &lt;s&gt;
*         WHERE mandt = &lt;v&gt;-mandt
*          AND report = &lt;v&gt;-report
*         AND variant = &lt;v&gt;-variant.
*      INSERT &lt;s&gt; INTO TABLE s_vari-screens.
*    ENDLOOP.
    s_vari-params = get_variant_params( program = &lt;v&gt;-report   variant = &lt;v&gt;-variant ).
    INSERT s_vari INTO TABLE result.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="SET_PARAM_VALUE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Return Param value from subroutine pool"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="VALUE" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="STRING"/>
     </PARAMETERS>
     <SOURCE>`
  value = current_param-value.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="SET_SELECTOPTION_VALUE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Return Select options value form subroutine pool"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="VALUE" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TR_SO_VALUE"/>
     </PARAMETERS>
     <SOURCE>`
  value = current_param-values.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="SET_VARIANT_PARAMS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Get Variant parameters"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="DATA" VERSION="1" CMPTYPE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_VARIANT_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Variant data"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="PROGRAM" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_PROGNAME">
       <TEXTS>
        <ITEM LANG="E" TEXT="Program name"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="ABAP_BOOL">
       <TEXTS>
        <ITEM LANG="E" TEXT="Everything was OK"/>
       </TEXTS>
      </ITEM>
      <ITEM SCONAME="VARIANT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_VARIANT">
       <TEXTS>
        <ITEM LANG="E" TEXT="ABAP: Name of variant (without program name)"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  TYPES tt_vdat TYPE STANDARD TABLE OF rsvarivdat.
  TYPES tt_vdyn TYPE STANDARD TABLE OF rsvaridyn.
  TYPES tt_vdd  TYPE STANDARD TABLE OF rsvdatdyn.
  DATA p_key     TYPE rsvarkey.
  DATA t_screens TYPE STANDARD TABLE OF rsscr.
  DATA t_vari    TYPE STANDARD TABLE OF rvari.
  DATA p_subrc   TYPE sy-subrc.
  DATA p_subrc_s TYPE sy-subrc.
  DATA d_param   LIKE LINE OF current_param-params.
  DATA t_dyns_fields TYPE STANDARD TABLE OF rsdsfields WITH DEFAULT KEY.
  DATA t_varivdat TYPE tt_vdat.
  DATA t_varidyn TYPE tt_vdyn.
  DATA t_vdatdyn TYPE tt_vdd.
  DATA t_texpr   TYPE rsds_texpr.
  DATA s_vdat    LIKE LINE OF t_varivdat.
  DATA: BEGIN OF imex,
          vari,
          dyns,
        END   OF imex.
  FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF t_vari,
    &lt;p&gt; LIKE LINE OF current_param-params,
    &lt;v&gt; LIKE LINE OF data.
  DATA: BEGIN OF l_formname_0,
          prefix(7) VALUE &apos;%_LINK_&apos;,
          suffix(8),
        END OF l_formname_0.

  DATA d_formname TYPE string.

  p_key-report = program.
  p_key-variant = variant.
  result = abap_true.

* CALL FUNCTION &apos;SELTAB_2_SELOPTS&apos;

  PERFORM import_var_selc IN PROGRAM saplsvar TABLES t_screens t_vari
                                               USING p_key-report p_key
                                            CHANGING p_subrc p_subrc_s.

  PERFORM set_object IN PROGRAM (report) USING me IF FOUND.   &quot; for installer
  IF 1 = 2.   PERFORM set_object IN PROGRAM zaplink_vari USING me IF FOUND.  ENDIF.
*  SORT t_screens BY name.
*perform brepi(rsdbspva) in MF : RS_VARIANT_CONTENTS
  LOOP AT data INTO current_param.
    READ TABLE t_vari ASSIGNING &lt;s&gt; WITH KEY name = current_param-name.    &quot; BINARY SEARCH.
    CHECK sy-subrc = 0.   &quot; Else ignore field value
    &lt;s&gt;-vtype = current_param-vtype.    &lt;s&gt;-vname = current_param-vname.
    &lt;s&gt;-appendage = current_param-appendage.    &lt;s&gt;-invisible = current_param-invisible.    &lt;s&gt;-protected = current_param-protected.
* FROM MF RS_CHANGE_CREATED_VARIANT (134)
    IF current_param-spagpa = abap_true.    &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-AND flags-vari-spagpa.    ELSE.   &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-OR flags-vari-nospagpa.   ENDIF.
*    IF &lt;v&gt;-xflag1 O flags-vari-obli.        current_param-obli = abap_true.         ENDIF.
    IF current_param-obli = abap_true.      &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-OR flags-vari-obli.       ELSE.   &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-AND flags-vari-no_obli.   ENDIF.
*    IF &lt;v&gt;-xflag1 O flags-varid-noimp.      current_param-no_import = abap_true.    ENDIF.
    IF current_param-no_import = abap_true. &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-OR flags-varid-noimp.     ELSE.   &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-AND flags-varid-imp.      ENDIF.
*    IF &lt;v&gt;-xflag1 O flags-vari-noint.       current_param-noint = abap_true.        ENDIF.
    IF current_param-noint = abap_true.     &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-OR flags-vari-noint.      ELSE.   &lt;s&gt;-xflag1 = &lt;s&gt;-xflag1 BIT-AND flags-vari-int.       ENDIF.
* END FROM MF RS_CHANGE_CREATED_VARIANT (134)
    MOVE &lt;s&gt;-name TO l_formname_0-suffix.
    CONCATENATE &apos;SET_VAL_&apos; &lt;s&gt;-kind INTO d_formname.
    IF 1 = 2.                                               &quot;#EC *
*      PERFORM set_val_s IN PROGRAM zaplink_vari TABLES space                     &quot;#EC *
*                USING space space space space space IF FOUND.   &quot;#EC *
      PERFORM set_val_p IN PROGRAM zaplink_vari USING space space space IF FOUND. &quot;#EC *
    ENDIF.
    PERFORM (l_formname_0) IN PROGRAM (p_key-report)
           USING report d_formname p_subrc IF FOUND.
    IF p_subrc &lt;&gt; 0.    result = abap_false.    ENDIF.
    LOOP AT current_param-params ASSIGNING &lt;p&gt;.
      CLEAR s_vdat.   MOVE-CORRESPONDING &lt;p&gt; TO s_vdat.   s_vdat-selname = current_param-name.
      APPEND s_vdat TO t_varivdat.
    ENDLOOP.
  ENDLOOP.
  PERFORM clear_object IN PROGRAM (report) USING me IF FOUND.   &quot; for installer
  IF 1 = 2.   PERFORM clear_object IN PROGRAM zaplink_vari USING me IF FOUND.   ENDIF.

* MF RS_CREATE_VARIANT
  PERFORM export_variant_static IN PROGRAM rsdbspvd TABLES   t_dyns_fields
                                                     USING   t_vari
                                                             t_varivdat
                                                             t_varidyn
                                                             t_vdatdyn
                                                             t_texpr imex
                                                             p_key
                                                             p_subrc.
  IF p_subrc &lt;&gt; 0.    result = abap_false.    ENDIF.

  PERFORM export_%_vari IN PROGRAM saplsvar USING p_key-report
                                                  p_key
                                                  sy-mandt
                                                  space.    &quot; FLAG_NOIMPORT.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="WRITE_VARIANTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Read variant from SAP"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TT_VARIANTS"/>
      <ITEM SCONAME="VARIANTS" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TT_VARIANTS"/>
     </PARAMETERS>
     <SOURCE>`
  DATA t_varis     TYPE STANDARD TABLE OF rsdynnr WITH DEFAULT KEY.
  DATA t_varit     TYPE STANDARD TABLE OF varit WITH DEFAULT KEY.
  DATA t_params    TYPE STANDARD TABLE OF rsparams WITH DEFAULT KEY.
  DATA s_param     LIKE LINE OF t_params.
  DATA d_subrc     TYPE sy-subrc.
*  DATA t_rep       TYPE STANDARD TABLE OF string.
  DATA d_is_work_i  TYPE abap_bool.
  DATA d_is_inactiv TYPE abap_bool.
  DATA d_obj_name   TYPE e071-obj_name.
  DATA t_variants   TYPE tt_variants.
  DATA f_ok         TYPE abap_bool.
  DATA o_activate   TYPE REF TO zaplink_activate.
  DATA t_comps      TYPE zaplink_list=&gt;tt_compkeys.
  DATA s_comp       LIKE LINE OF t_comps.
*  DATA s_vari      LIKE LINE OF result.
  FIELD-SYMBOLS:
*    &lt;t&gt; LIKE LINE OF t_varit,
*    &lt;s&gt; LIKE LINE OF t_varis,
    &lt;v&gt; LIKE LINE OF variants,
    &lt;p&gt; LIKE LINE OF &lt;v&gt;-params,
    &lt;val&gt; LIKE LINE OF &lt;p&gt;-values.

  t_variants = variants.    SORT t_variants.    s_comp-type = &apos;PROG&apos;.
  LOOP AT t_variants ASSIGNING &lt;v&gt;.
    AT NEW header-report.
      f_ok = abap_true.
*    READ REPORT &lt;v&gt;-header-report INTO t_rep STATE &apos;A&apos;.   &quot; Check for active program existence
      d_obj_name = &lt;v&gt;-header-report.
      CALL FUNCTION &apos;RS_OBJECT_IN_WORKING_AREA&apos;
        EXPORTING
          object                        = &apos;REPS&apos;
          obj_name                      = d_obj_name
*     GLOBAL_CHECK                  = &apos; &apos;
*     MODE                          = &apos;S&apos;
        IMPORTING
          object_is_work_item           = d_is_work_i     &quot; My inactive object
          object_inactive_version       = d_is_inactiv.
      IF NOT d_is_work_i IS INITIAL OR NOT d_is_inactiv IS INITIAL.
        REFRESH t_comps.    s_comp-name = &lt;v&gt;-header-report.    APPEND s_comp TO t_comps.
        CREATE OBJECT o_activate.
        o_activate-&gt;add_keys( t_comps ).
        t_comps = o_activate-&gt;activate( ).
        IF NOT t_comps IS INITIAL.      CLEAR f_ok.     ENDIF.
      ENDIF.
    ENDAT.

    IF f_ok IS INITIAL.
* Can&apos;t insert variant &apos;&amp;1&apos; for program &apos;&amp;2&apos;, because do not exist as active
      SET EXTENDED CHECK OFF.
      IF 1 = 2.   MESSAGE i003 WITH &lt;v&gt;-header-report &lt;v&gt;-header-variant.   ENDIF.
      SET EXTENDED CHECK ON.
      CALL METHOD application_log-&gt;add_error
        EXPORTING
*        id_msgid     =
          id_msgno     = &apos;003&apos;
*        id_msgv4     =
          id_msgv1     = &lt;v&gt;-header-report
          id_msgv2     = &lt;v&gt;-header-variant.
    ENDIF.
    CHECK f_ok = abap_true.

    REFRESH t_params.
    LOOP AT &lt;v&gt;-params ASSIGNING &lt;p&gt;.
      IF NOT &lt;p&gt;-value IS INITIAL.
        CLEAR s_param.    s_param-kind = &apos;P&apos;.       s_param-selname = &lt;p&gt;-name.     s_param-low = &lt;p&gt;-value.                  APPEND s_param TO t_params.
      ELSEIF NOT &lt;p&gt;-values IS INITIAL.
        LOOP AT &lt;p&gt;-values ASSIGNING &lt;val&gt;.
          CLEAR s_param.    s_param-kind = &apos;S&apos;.     s_param-selname = &lt;p&gt;-name.     MOVE-CORRESPONDING &lt;val&gt; TO s_param.      APPEND s_param TO t_params.
        ENDLOOP.
      ENDIF.
    ENDLOOP.
    t_varit = &lt;v&gt;-texts.
    t_varis = &lt;v&gt;-screens.
    CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
      EXPORTING
        report              = &lt;v&gt;-header-report
        variant             = &lt;v&gt;-header-variant
      IMPORTING
        r_c                 = d_subrc
      EXCEPTIONS
        not_authorized      = 1
        no_report           = 2
        report_not_existent = 3
        report_not_supplied = 4
        OTHERS              = 5.
    IF sy-subrc = 0 AND d_subrc = 0.
      CALL FUNCTION &apos;RS_VARIANT_DELETE&apos;
        EXPORTING
          report                     = &lt;v&gt;-header-report
          variant                    = &lt;v&gt;-header-variant
          flag_confirmscreen         = abap_true
          flag_delallclient          = abap_true    &quot; other wise popup screen
*       IMPORTING
*         VARIANT                    =
        EXCEPTIONS
          not_authorized             = 1
          not_executed               = 2
          no_report                  = 3
          report_not_existent        = 4
          report_not_supplied        = 5
          variant_locked             = 6
          variant_not_existent       = 7
          no_corr_insert             = 8
          variant_protected          = 9
          OTHERS                     = 10.
      IF sy-subrc &lt;&gt; 0.
        MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
                WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
      ENDIF.
    ENDIF.

    CALL FUNCTION &apos;RS_CREATE_VARIANT&apos;
      EXPORTING
        curr_report               = &lt;v&gt;-header-report
        curr_variant              = &lt;v&gt;-header-variant
        vari_desc                 = &lt;v&gt;-header
      TABLES
        vari_contents             = t_params
        vari_text                 = t_varit
        vscreens                  = t_varis
      EXCEPTIONS
        illegal_report_or_variant = 1
        illegal_variantname       = 2
        not_authorized            = 3
        not_executed              = 4
        report_not_existent       = 5
        report_not_supplied       = 6
        variant_exists            = 7
        variant_locked            = 8
        OTHERS                    = 9.
    IF sy-subrc &lt;&gt; 0.
      MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
    ELSE.
*    PERFORM enq_variant IN PROGRAM saplsvar USING &lt;v&gt;-header-report &lt;v&gt;-header-variant.      &quot; Not release by function it seems
      IF set_variant_params( program = &lt;v&gt;-header-report   variant = &lt;v&gt;-header-variant    data = &lt;v&gt;-params ) = abap_true.
        APPEND &lt;v&gt; TO result.
      ENDIF.
      PERFORM deq_variant IN PROGRAM saplsvar USING &lt;v&gt;-header-report &lt;v&gt;-header-variant.
    ENDIF.
  ENDLOOP.</SOURCE>
    </ITEM>
   </METHODS>
   <REDEFINITIONS>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE">
     <SOURCE>`
  DATA o_prog     TYPE to_program.
  DATA o_variant  TYPE to_variant.

  CHECK object IS BOUND.

  CASE object-&gt;type.
    WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
      o_variant ?= object-&gt;raw.
      o_variant-&gt;anonymize( ).
    WHEN supportedtypes-program.
      o_prog ?= object-&gt;raw.
      o_prog-&gt;anonymize( ).
    WHEN OTHERS.
      mac_raise_type_not_supported me-&gt;class_name object-&gt;type.
  ENDCASE.

  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE">
     <SOURCE>`
  DATA o_prog     TYPE to_program.
  DATA o_variant  TYPE to_variant.

  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~unanonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.

  CHECK object IS BOUND.

  CASE object-&gt;type.
    WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
      o_variant ?= object-&gt;raw.
      o_variant-&gt;unanonymize( ).
    WHEN supportedtypes-program.
      o_prog ?= object-&gt;raw.
      o_prog-&gt;unanonymize( ).
    WHEN OTHERS.
      mac_raise_type_not_supported me-&gt;class_name object-&gt;type.
  ENDCASE.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE">
     <SOURCE>`
  DATA d_type TYPE td_comptype.
  DATA d_prog TYPE td_progname.

  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN supportedtypes-program.
        d_prog = component-&gt;get_name( ).
        result = get_program_signature( d_prog ).
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name d_type.
    ENDCASE.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~CREATE_NEW_RAW">
     <SOURCE>`
  DATA o_prog     TYPE to_program.
  DATA o_variant  TYPE to_variant.
  DATA o_raw_var  TYPE to_raw_variant.

  CASE type.
    WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
      CREATE OBJECT o_raw_var.
      object = o_raw_var.
      CREATE OBJECT o_variant.
      object-&gt;raw = o_variant.
    WHEN supportedtypes-program.
      CREATE OBJECT object.
      CREATE OBJECT o_prog.
      object-&gt;raw = o_prog.
    WHEN OTHERS.
      CLEAR object.
      mac_raise_type_not_supported me-&gt;class_name type.
  ENDCASE.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~DELETE_FROM_SAP">
     <SOURCE>`
  DATA d_name     TYPE td_compname.
  DATA type       TYPE td_comptype.
  DATA program    TYPE sy-repid.
  DATA s_variant  TYPE ts_variant_key.

  TRY.
    type = component-&gt;get_type( ).
    d_name = component-&gt;get_name( ).
    CASE type.
      WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
        CHECK do_exists( component ) = exists-exists.     &quot; UI when variant do not exists (detected with Issue 104)
        s_variant = zaplink_vari_data=&gt;name_2_key( d_name ).
        CALL FUNCTION &apos;RS_VARIANT_DELETE&apos;
          EXPORTING
            report                     = s_variant-program
            variant                    = s_variant-variant
*           FLAG_CONFIRMSCREEN         =
            flag_delallclient          = abap_true
*         IMPORTING
*           VARIANT                    =
          EXCEPTIONS
            not_authorized             = 1
            not_executed               = 2
            no_report                  = 3
            report_not_existent        = 4
            report_not_supplied        = 5
            variant_locked             = 6
            variant_not_existent       = 7
            no_corr_insert             = 8
            variant_protected          = 9
            OTHERS                     = 10.
        IF sy-subrc &lt;&gt; 0.
          mac_add_mf_and_raise &apos;RS_VARIANT_DELETE&apos; sy-subrc.
        ENDIF.
      WHEN supportedtypes-program.
        program = d_name.
        CALL FUNCTION &apos;RS_DELETE_PROGRAM&apos;
          EXPORTING
*          CORRNUMBER                       =
            program                          = program
*          SUPPRESS_CHECKS                  = &apos; &apos;
*          SUPPRESS_COMMIT                  = &apos; &apos;
            suppress_popup                   = &apos;X&apos;
*          MASS_DELETE_CALL                 = &apos; &apos;
*          WITH_CUA                         = &apos;X&apos;
*          WITH_DOCUMENTATION               = &apos;X&apos;
*          WITH_DYNPRO                      = &apos;X&apos;
*          WITH_INCLUDES                    = &apos; &apos;
*          WITH_TEXTPOOL                    = &apos;X&apos;
*          WITH_VARIANTS                    = &apos;X&apos;
*          TADIR_DEVCLASS                   =
*          SKIP_PROGRESS_IND                = &apos; &apos;
*          FORCE_DELETE_USED_INCLUDES       = &apos; &apos;
*        IMPORTING
*          CORRNUMBER                       =
*          PROGRAM                          =
          EXCEPTIONS
            enqueue_lock                     = 1
            object_not_found                 = 2
            permission_failure               = 3
            reject_deletion                  = 4
            OTHERS                           = 5.
        IF sy-subrc &lt;&gt; 0.
          mac_add_mf_and_raise &apos;RS_DELETE_PROGRAM&apos; sy-subrc.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name type.
    ENDCASE.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~DO_EXISTS">
     <SOURCE>`
  DATA d_name     TYPE td_compname.
  DATA type       TYPE td_comptype.
  DATA d_subrc    TYPE sy-subrc.
  DATA s_variant  TYPE ts_variant_key.

  exists = me-&gt;exists-not_exists.

  TRY.
    type = component-&gt;get_type( ).
    d_name = component-&gt;get_name( ).
    CASE type.
      WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
        s_variant = zaplink_vari_data=&gt;name_2_key( d_name ).
        CALL FUNCTION &apos;RS_VARIANT_EXISTS&apos;
          EXPORTING
            report              = s_variant-program
            variant             = s_variant-variant
          IMPORTING
            r_c                 = d_subrc
          EXCEPTIONS
            not_authorized      = 1
            no_report           = 2
            report_not_existent = 3
            report_not_supplied = 4
            OTHERS              = 5.
        IF sy-subrc = 0 AND d_subrc = 0.    exists = me-&gt;exists-exists.   ENDIF.
      WHEN supportedtypes-program.
        SELECT SINGLE name INTO d_name
          FROM trdir
          WHERE name = d_name.
        IF sy-subrc = 0.    exists = me-&gt;exists-exists.   ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name type.
    ENDCASE.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~GET_VALUES">
     <SOURCE>`
  DATA s_variant   TYPE ts_variant_key.                     &quot; Issue 53
  CASE type.
    WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
      s_variant = zaplink_vari_data=&gt;name_2_key( name ).
      IF s_variant-program IS INITIAL.
        CALL METHOD super-&gt;zaplink_connector~get_values
          EXPORTING
            type = supportedtypes-program
          CHANGING
            name = name.
        s_variant-program = name.
      ENDIF.
      CHECK NOT s_variant-program IS INITIAL.
      CALL FUNCTION &apos;RS_VARIANT_CATALOG&apos;
        EXPORTING
          report                     = s_variant-program
*         NEW_TITLE                  = &apos; &apos;
*         DYNNR                      =
*         INTERNAL_CALL              = &apos; &apos;
*         MASKED                     = &apos;X&apos;
          variant                    = s_variant-variant
*         POP_UP                     = &apos; &apos;
        IMPORTING
          sel_variant                = s_variant-variant
*         SEL_VARIANT_TEXT           =
*       TABLES
*         BELONGING_DYNNR            =
        EXCEPTIONS
          no_report                  = 1
          report_not_existent        = 2
          report_not_supplied        = 3
          no_variants                = 4
          no_variant_selected        = 0
          variant_not_existent       = 6
          OTHERS                     = 7.
      IF sy-subrc &lt;&gt; 0.
        MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
                WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
      ELSE.
        name = zaplink_vari_data=&gt;key_2_name( s_variant ).
      ENDIF.
    WHEN supportedtypes-program.
      CALL METHOD super-&gt;zaplink_connector~get_values
        EXPORTING
          type = type
        CHANGING
          name = name.
    WHEN OTHERS.
      mac_raise_type_not_supported me-&gt;class_name type.
  ENDCASE.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION">
     <SOURCE>`
  result = abap_false.    if version = _ver.    result = abap_true.   endif.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~READ_FROM_SAP">
     <SOURCE>`
  TYPES:                                                    &quot; Issue 7
    BEGIN OF ts_doc,
      prog TYPE programm,
      wildcard(1) TYPE c,
    END OF ts_doc.
  DATA s_obj       TYPE ts_doc.                             &quot; Issue 7
  DATA o_prog      TYPE to_program.
  DATA s_fmd_prog  TYPE ts_fm_data.
  DATA o_variant   TYPE to_variant.
  DATA s_fmd_vari  TYPE ts_fmd_vari.
  DATA _prog       TYPE td_progname.
  DATA d_name      TYPE td_compname.
  DATA _obj        TYPE doku_obj.
  DATA type        TYPE td_comptype.
  DATA t_varid     TYPE tt_variant_list.                    &quot; Issue 53
  DATA s_variant   TYPE ts_variant_key.                     &quot; Issue 53
*  DATA s_vari      LIKE LINE OF s_fmd_prog-variants.        &quot; Issue 53
  DATA f_subcomp   TYPE td_with_subcomp.
  DATA l_mandt     LIKE sy-mandt.                           &quot; Issue 99

  TRY.
    type = component-&gt;get_type( ).
    d_name = component-&gt;get_name( ).
    f_subcomp = component-&gt;get_with_subcomp( ).
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    CASE type.
      WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
        CREATE OBJECT o_variant.
        object-&gt;raw = o_variant.
        s_variant = zaplink_vari_data=&gt;name_2_key( d_name ).
        PERFORM get_mandt IN PROGRAM saplsvar USING s_variant-variant &quot; Issue 99
                                           CHANGING l_mandt.
*        CASE type.                                         &quot; Issue 99
*          WHEN supportedtypes-sys_variant.
        SELECT * UP TO 1 ROWS
          INTO TABLE t_varid
          FROM varid CLIENT SPECIFIED
          WHERE mandt = l_mandt
            AND report = s_variant-program
            AND variant = s_variant-variant.
*          WHEN OTHERS.
*            SELECT * UP TO 1 ROWS
*              INTO TABLE t_varid
*              FROM varid
*              WHERE report = s_variant-program
*                AND variant = s_variant-variant.
*        ENDCASE.
        s_fmd_prog-variants = read_variants( t_varid ).
        CHECK NOT s_fmd_prog-variants IS INITIAL.
        READ TABLE s_fmd_prog-variants INDEX 1 INTO s_fmd_vari.
        o_variant-&gt;from_data( s_fmd_vari ).
        CLEAR: o_variant-&gt;a0_maindata-mandt, o_variant-&gt;a0_maindata-report, o_variant-&gt;a0_maindata-variant.
      WHEN supportedtypes-program.
        _prog = d_name = object-&gt;name.
        CREATE OBJECT o_prog.
        SELECT SINGLE *
          INTO s_fmd_prog-header
          FROM progdir    &quot; reposrc
*The databae view &quot;REPOSRC&quot; is write-protected, so it cannot be changed.
          WHERE name = d_name
            AND state = &apos;A&apos;.        &quot; Active
        IF sy-subrc &lt;&gt; 0.
          SELECT SINGLE *
            INTO s_fmd_prog-header
            FROM progdir    &quot;reposrc
            WHERE name = d_name
              AND state = &apos;I&apos;.      &quot; Inactive
        ENDIF.

* Source code
        s_fmd_prog-source = get_prog_source( _prog ).
*    INCLUDE TYPE reposrc. &quot;The databae view &quot;REPOSRC&quot; is write-protected, so it cannot be changed.

* Texts Pool
        s_fmd_prog-textspool = get_prog_textpool( _prog ).

* Dynpro : Issue 8
        s_fmd_prog-dynpros = get_dynpros( _prog ).

* Menu Painter : Issue 9
        s_fmd_prog-menupainter = get_menus( _prog ).

        SELECT *
          INTO TABLE s_fmd_prog-texts
          FROM trdirti
          WHERE name = d_name.

* Documentation
*      CONCATENATE _name &apos;*&apos; INTO _obj. &quot; Issue 7
        s_obj-prog = d_name.
        s_obj-wildcard = &apos;*&apos;.
        _obj = s_obj.
*Issue 7
        s_fmd_prog-docs = zaplink_documentation=&gt;get( ids = zaplink_prog_data=&gt;r_doc_ids-prog
                                                  object = _obj ).

* Issue 53
        IF f_subcomp &gt;= sub_component-with_mine.
          SELECT * INTO TABLE t_varid
            FROM varid CLIENT SPECIFIED
            WHERE mandt = &apos;000&apos;
              AND report = _prog.

          IF f_subcomp &gt;= sub_component-with_required.
            SELECT * APPENDING TABLE t_varid
              FROM varid
              WHERE report = _prog
                AND transport &lt;&gt; zaplink_vari_data=&gt;transport-normal.
            IF f_subcomp &gt;= sub_component-with_all.
              SELECT * APPENDING TABLE t_varid
                FROM varid
                WHERE report = _prog
                  AND transport = zaplink_vari_data=&gt;transport-normal.
            ENDIF.
          ENDIF.
          SORT t_varid BY mandt report variant. DELETE ADJACENT DUPLICATES FROM t_varid COMPARING mandt REPORT variant.

          s_fmd_prog-variants = read_variants( t_varid ).
        ENDIF.

        o_prog-&gt;from_data( s_fmd_prog ).
        o_prog-&gt;_code_signature = get_program_signature( o_prog-&gt;a0_maindata-name ).

        CLEAR o_prog-&gt;a0_maindata-name.
        object-&gt;raw = o_prog.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported me-&gt;class_name type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
    </ITEM>
    <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~WRITE_TO_SAP">
     <SOURCE>`
  DATA o_prog      TYPE to_program.
  DATA o_vari      TYPE to_variant.
  DATA s_variant   TYPE ts_variant_key.
  DATA _prog       TYPE programm.
  DATA _oname      TYPE e071-obj_name.
  DATA _rep        TYPE progdir.
  DATA o_comp      TYPE to_component.
*  DATA _name       TYPE td_compname.
  DATA s_fmd_prog  TYPE ts_fm_data.
  DATA s_fmd_vari  TYPE ts_fmd_vari.
  DATA t_vari      TYPE tt_variants.
  FIELD-SYMBOLS &lt;v&gt; LIKE LINE OF o_prog-&gt;variants.

  TRY.

    CREATE OBJECT components.                         &quot; Issue 92
    CASE object-&gt;type.
      WHEN supportedtypes-sys_variant OR supportedtypes-appl_variant.
        o_vari ?= object-&gt;raw.    s_variant = zaplink_vari_data=&gt;name_2_key( object-&gt;name ).
        o_vari-&gt;a0_maindata-report = s_variant-program.   o_vari-&gt;a0_maindata-variant = s_variant-variant.
        s_fmd_vari = o_vari-&gt;to_data( ).    APPEND s_fmd_vari TO s_fmd_prog-variants.
        write_variants( s_fmd_prog-variants ).

      WHEN supportedtypes-program.
        o_prog ?= object-&gt;raw.
        _oname = _prog = o_prog-&gt;a0_maindata-name = object-&gt;name.
        s_fmd_prog = o_prog-&gt;to_data( ).
        CALL FUNCTION &apos;RS_INSERT_INTO_WORKING_AREA&apos;
          EXPORTING
            object                  = &apos;REPS&apos;
            obj_name                = _oname
*              DELETED_FLAG            = &apos; &apos;
*           IMPORTING
*             OBJECT_INSERTED         =
          EXCEPTIONS
            wrong_object_name       = 1
            OTHERS                  = 2.
        IF sy-subrc &lt;&gt; 0.
          mac_add_mf_and_raise &apos;RS_INSERT_INTO_WORKING_AREA&apos; sy-subrc.
        ENDIF.

        CALL FUNCTION &apos;RS_INSERT_INTO_WORKING_AREA&apos;
          EXPORTING
            object                  = &apos;REPT&apos;
            obj_name                = _oname
*              DELETED_FLAG            = &apos; &apos;
*            IMPORTING
*              OBJECT_INSERTED         =
          EXCEPTIONS
            wrong_object_name       = 1
            OTHERS                  = 2.
        IF sy-subrc &lt;&gt; 0.
          mac_add_mf_and_raise &apos;RS_INSERT_INTO_WORKING_AREA&apos; sy-subrc.
        ENDIF.

        MOVE-CORRESPONDING s_fmd_prog-header TO _rep.
        _rep-state = &apos;I&apos;.   MODIFY progdir FROM _rep.
*      MODIFY reposrc FROM _rep. &quot;The databae view &quot;REPOSRC&quot; is write-protected, so it cannot be changed.
        _rep-state = &apos;A&apos;.   MODIFY progdir FROM _rep.

* Source code
        set_prog_source( program = _prog
                          source = s_fmd_prog-source ).
* Text Pool
        set_prog_textpool( program = _prog
                          textpool = s_fmd_prog-textspool ).
* Dynpro : Issue 8
        set_dynpros( program = _prog
                     dynpros = s_fmd_prog-dynpros ).

* Menu Painter : Issue 9
        set_menus( program = _prog
                     menus = s_fmd_prog-menupainter ).

* Documentation
        zaplink_documentation=&gt;set( t_docs = s_fmd_prog-docs ).

*Texts
        DELETE FROM trdirti WHERE name = s_fmd_prog-header-name.
        MODIFY trdirti FROM TABLE s_fmd_prog-texts.

* Variants
        t_vari = write_variants( s_fmd_prog-variants ).
        LOOP AT o_prog-&gt;variants ASSIGNING &lt;v&gt;.
          o_vari ?= &lt;v&gt;-zl_object-&gt;raw.
          READ TABLE t_vari TRANSPORTING NO FIELDS WITH KEY header-variant = o_vari-&gt;a0_maindata-variant.
          IF sy-subrc = 0.
            o_comp = &lt;v&gt;-zl_object-&gt;get_component( abap_true ).
            components-&gt;add( o_comp ).    components-&gt;select( o_comp ).
* Done in Write_variants
*          ELSE.
** Can&apos;t insert variant &apos;&amp;1&apos; for program &apos;&amp;2&apos;, because don&apos;t exist as active
*            SET EXTENDED CHECK OFF.
*            IF 1 = 2.   MESSAGE i003 WITH space space.   ENDIF.
*            SET EXTENDED CHECK ON.
*            CALL METHOD application_log-&gt;add_error
*              EXPORTING
**                id_msgid = &apos;ZAPLINK&apos;
*                id_msgno = &apos;003&apos;
*                id_msgv1 = s_fmd_prog-header-name
*                id_msgv2 = o_vari-&gt;a0_maindata-variant.
          ENDIF.
        ENDLOOP.

      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name object-&gt;type.
    ENDCASE.
    check_component_list( EXPORTING     object = object
                           CHANGING components = components ). &quot; Issue 92
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
    </ITEM>
   </REDEFINITIONS>
   <TYPEGROUPS>
    <ITEM TYPEGROUP="ABAP" VERSION="1" EXPLICIT="X"/>
    <ITEM TYPEGROUP="RSDS" VERSION="1" EXPLICIT="X"/>
   </TYPEGROUPS>
   <TYPES>
    <ITEM CMPNAME="TD_VARIANT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="VARID-VARIANT" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="ABAP: Name of variant (without program name)"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TO_PROGRAM" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="3" TYPE="ZAPLINK_PROG_DATA" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Data for Program"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TO_RAW_VARIANT" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_PROG_DATA=&gt;TO_VARIANT" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Variant Raw object"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TO_VARIANT" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="3" TYPE="ZAPLINK_VARI_DATA" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Data for Variant"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TR_SO_VALUE" VERSION="1" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_VARI_DATA=&gt;TR_STRING" R3RELEASE="701"/>
    <ITEM CMPNAME="TS_FMD_VARI" VERSION="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_VARI_DATA=&gt;TS_FM_DATA" R3RELEASE="701"/>
    <ITEM CMPNAME="TS_FM_DATA" VERSION="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_PROG_DATA=&gt;TS_FM_DATA" R3RELEASE="701"/>
    <ITEM CMPNAME="TS_PROG_ATTR" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_prog_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_prog_attr
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Program Attributs"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_SOURCE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="STRING" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="ABAP Source code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_SO_VALUE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="9 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">begin of ts_so_value,
        sign    type BAPISIGN,
        option  type BAPIOPTION,
        low     type string,
        high    type string,
      END OF ts_so_value
`</ITEM>
    <ITEM CMPNAME="TS_TEXT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_text,
        langu   TYPE spras,
        entry	  TYPE textpooltx,
        length  TYPE textpoolln,
      END OF ts_text
`</ITEM>
    <ITEM CMPNAME="TS_TEXTPOOL" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_textpool,
        id    TYPE  textpoolid,
        key	  TYPE  textpoolky,
        texts TYPE  tt_texts,
      END OF ts_textpool
`</ITEM>
    <ITEM CMPNAME="TS_VARIANT_KEY" VERSION="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_VARI_DATA=&gt;TS_VARIANT_KEY" R3RELEASE="701"/>
    <ITEM CMPNAME="TT_TEXTPOOLS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     tt_textpools TYPE SORTED TABLE OF ts_textpool WITH UNIQUE KEY id KEY
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Table of textppool"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TT_TEXTS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_texts TYPE SORTED TABLE OF ts_text WITH UNIQUE KEY langu
`</ITEM>
    <ITEM CMPNAME="TT_VARIANTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_PROG_DATA=&gt;TT_VARI_DATA" R3RELEASE="701"/>
    <ITEM CMPNAME="TT_VARIANT_DATA" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_VARI_DATA=&gt;TT_PARAMS" R3RELEASE="701"/>
    <ITEM CMPNAME="TT_VARIANT_LIST" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_variant_list TYPE STANDARD TABLE OF varid WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="T_RAW" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="RSWSOURCET" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="ABAP Source"/>
     </TEXTS>
    </ITEM>
   </TYPES>
  </RAW>
 </ZL_OBJECT>
 <ZL_OBJECT CHECKSUM="666F3DD9828576FC5DB9E27D3D43298B" CODE_SIGNATURE="0B19AF7322DC88DAC9072E5ED400FE74" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_PROG_DATA" TYPE="CLAS" VERSION="1.01">
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20091005" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="701">
    <INHERITANCE REFCLSNAME="ZAPLINK_RAW_DATA" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <TEXTS>
     <ITEM LANG="E" TEXT="Commun Data for Class &amp; Interface">U1&amp;FUNCTIONALITY&amp;
ASIs part of connector : ZAPLINK_PROGRAM
ASDefine XML structure of a Program
U1&amp;RELATIONS&amp;
AS
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AS
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
    </TEXTS>
   </A0_MAINDATA>
   <ALIASES>
    <ITEM CMPNAME="LINE_SEPARATOR" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="LINE_SEPARATOR"/>
    <ITEM CMPNAME="TD_ABAPSOURCE" VERSION="1" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_ABAPSOURCE"/>
    <ITEM CMPNAME="TD_DOC_ID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DOC_ID"/>
    <ITEM CMPNAME="TR_DOCID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_DOCID"/>
    <ITEM CMPNAME="TS_SOURCEASSTRUC" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_SOURCEASSTRUC"/>
    <ITEM CMPNAME="TT_DOCS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_DOCS"/>
    <ITEM CMPNAME="TT_DYNPROS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_DYNPROS"/>
    <ITEM CMPNAME="TT_TEXTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TEXTS"/>
    <ITEM CMPNAME="TT_TXTP_TEXTPOOLS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TXTP_TEXTPOOLS"/>
   </ALIASES>
   <ATTRIBUTS>
    <ITEM CMPNAME="A0_MAINDATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TS_MAINDATA" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Program main data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="DOCUMENTATION_OFF" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_DOCS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="No longer used"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="DOC_IDS" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">BEGIN OF DOC_IDS,
      Prog      TYPE td_doc_id VALUE &apos;RE&apos;,    &quot; Report
    END OF DOC_IDS
`</ITEM>
    <ITEM CMPNAME="DYNPROS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_DYNPROS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="DynPro informations"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="MENUPAINTER" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TO_MENUPAINTER" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Menu painter Data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="R_DOC_IDS" VERSION="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="1" TYPTYPE="4" R3RELEASE="701">BEGIN OF R_DOC_IDS,
      prog     TYPE TR_DOCID,
    END OF R_DOC_IDS
`</ITEM>
    <ITEM CMPNAME="SOURCE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TS_SOURCEASSTRUC" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="ABAP Source code"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TEXTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_TEXTS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Program texts"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TEXTSPOOL" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_TXTP_TEXTPOOLS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Textpool table"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="VARIANTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_VARIANTS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Program&apos;s Variants"/>
     </TEXTS>
    </ITEM>
   </ATTRIBUTS>
   <FRIENDS>
    <ITEM REFCLSNAME="ZAPLINK_EASYXML" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <ITEM REFCLSNAME="ZAPLINK_PROGRAM" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
   </FRIENDS>
   <INTERFACES>
    <ITEM REFCLSNAME="ZAPLINK_DATATYPES" VERSION="1" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018" RELTYPE="1"/>
   </INTERFACES>
   <LOCAL>
    <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
    <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
    <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* in the implementation part of the class</MACROS>
   </LOCAL>
   <METHODS>
    <ITEM CMPNAME="ANONYMIZE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDNEWEXC="X" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Anonymized component data"/>
     </TEXTS>
     <EXCEPTIONS>
      <ITEM SCONAME="ZAPLINK_CX" VERSION="1" LANGU="E" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018">
       <TEXTS>
        <ITEM LANG="E" TEXT="ZAPlink Framework : Root exception class"/>
       </TEXTS>
      </ITEM>
     </EXCEPTIONS>
     <SOURCE>`
  FIELD-SYMBOLS &lt;v&gt; LIKE LINE OF variants.
  CLEAR: a0_maindata-cnam, a0_maindata-cdat, a0_maindata-unam, a0_maindata-udat, a0_maindata-sdate, a0_maindata-stime, a0_maindata-idate,
         a0_maindata-itime, a0_maindata-vern, a0_maindata-state. &quot; Issue 68.
  LOOP AT variants ASSIGNING &lt;v&gt;.
    &lt;v&gt;-zl_object-&gt;anonymize( ).
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="CLASS_CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDTYPE="2" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="CLASS_CONSTRUCTOR"/>
     </TEXTS>
     <SOURCE>`
*table TDCLT
*DOKCLASS DOKTITEL
*RE       Report/Function Group, Logical DB                            Program/module pool
  DATA _id LIKE LINE OF r_doc_ids-prog.

  _id-sign = &apos;I&apos;.   _id-option = &apos;EQ&apos;.
  _id-low = doc_ids-prog.      APPEND _id TO r_doc_ids-prog.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="FROM_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDNEWEXC="X" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert FM Data to object attributes"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Modules object Data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <EXCEPTIONS>
      <ITEM SCONAME="ZAPLINK_CX" VERSION="1" LANGU="E" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018">
       <TEXTS>
        <ITEM LANG="E" TEXT="ZAPlink Framework : Root exception class"/>
       </TEXTS>
      </ITEM>
     </EXCEPTIONS>
     <SOURCE>`
  DATA s_txt     LIKE LINE OF texts.
  DATA t_docs    TYPE tt_docs.
  DATA s_variant LIKE LINE OF variants.
  FIELD-SYMBOLS:
    &lt;v&gt;  LIKE LINE OF fm_data-variants,
    &lt;d&gt;  LIKE LINE OF fm_data-docs,
    &lt;dt&gt; LIKE LINE OF &lt;d&gt;-texts,
    &lt;t&gt;  LIKE LINE OF fm_data-texts.

  a0_maindata = fm_data-header.
  textspool = fm_data-textspool.
  source-_ = fm_data-source.
  dynpros = fm_data-dynpros.
  menupainter = fm_data-menupainter.

  t_docs = fm_data-docs.
  READ TABLE t_docs ASSIGNING &lt;d&gt;
       WITH KEY id = doc_ids-prog
            object = a0_maindata-name.
  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_txt.    s_txt-langu = &lt;t&gt;-sprsl.   s_txt-short_txt = &lt;t&gt;-text.
    IF &lt;d&gt; IS ASSIGNED.
      READ TABLE &lt;d&gt;-texts ASSIGNING &lt;dt&gt;
          WITH KEY tdspras = s_txt-langu.
      IF sy-subrc = 0.    s_txt-long_txt = &lt;dt&gt;.   CLEAR s_txt-long_txt-tdspras.    DELETE TABLE &lt;d&gt;-texts FROM &lt;dt&gt;.    ENDIF.
    ENDIF.
    INSERT s_txt INTO TABLE texts.
  ENDLOOP.
  IF &lt;d&gt; IS ASSIGNED.
    LOOP AT &lt;d&gt;-texts ASSIGNING &lt;dt&gt;.
      CLEAR s_txt.    s_txt-langu = &lt;dt&gt;-tdspras.   s_txt-long_txt = &lt;dt&gt;.   CLEAR s_txt-long_txt-tdspras.    INSERT s_txt INTO TABLE texts.
    ENDLOOP.
  ENDIF.

  LOOP AT fm_data-variants ASSIGNING &lt;v&gt;.
    CREATE OBJECT s_variant-zl_object EXPORTING fm_data = &lt;v&gt;.
    APPEND s_variant TO variants.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="TO_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert object attributes to FM Data"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Modules object Data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt     LIKE LINE OF fm_data-texts.
  DATA s_doc     LIKE LINE OF fm_data-docs.
  DATA s_doc_txt LIKE LINE OF s_doc-texts.
  DATA s_variant LIKE LINE OF fm_data-variants.
  DATA d_variant TYPE zaplink_vari_data=&gt;ts_variant_key.
  FIELD-SYMBOLS:
    &lt;v&gt;  LIKE LINE OF variants,
    &lt;t&gt;  LIKE LINE OF texts.

  fm_data-header = a0_maindata.
  fm_data-textspool = textspool.
  fm_data-source = source-_.
  fm_data-dynpros = dynpros.
  fm_data-menupainter = menupainter.

*APPLICATION                                      DOKU
*ID	                                   	RE
*OBJECT	                                   	SAPLxxxx
*LANGU                                      E
*MASTERLANG	                                   	X
*TYP                                      E
*DOKFORM                                      S_DOCU_SHOW
*DOKSTYLE	                                   	S_DOCUS1
  s_doc-application = &apos;DOKU&apos;.   s_doc-id = doc_ids-prog.   s_doc-object = a0_maindata-name.
  s_doc-masterlang = abap_true.   s_doc-typ = &apos;E&apos;.    s_doc-dokform = &apos;S_DOCU_SHOW&apos;.    s_doc-dokstyle = &apos;S_DOCUS1&apos;.
  LOOP AT texts ASSIGNING &lt;t&gt;.
    IF NOT &lt;t&gt;-short_txt IS INITIAL.    CLEAR s_txt.    s_txt-sprsl = &lt;t&gt;-langu.   s_txt-text = &lt;t&gt;-short_txt.   INSERT s_txt INTO TABLE fm_data-texts.    ENDIF.
    IF NOT &lt;t&gt;-long_txt IS INITIAL.
      CLEAR s_doc_txt.    s_doc_txt = &lt;t&gt;-long_txt.   s_doc_txt-tdspras = &lt;t&gt;-langu.    INSERT s_doc_txt INTO TABLE s_doc-texts.
      IF s_doc-langu IS INITIAL.    s_doc-langu = s_doc_txt-tdspras.    ENDIF.
    ENDIF.
  ENDLOOP.
  IF NOT s_doc-texts IS INITIAL.    INSERT s_doc INTO TABLE fm_data-docs.   ENDIF.

  LOOP AT variants ASSIGNING &lt;v&gt;.
    d_variant = zaplink_vari_data=&gt;name_2_key( &lt;v&gt;-zl_object-&gt;name ).
    d_variant-program = fm_data-header-name.
    &lt;v&gt;-zl_object-&gt;name = zaplink_vari_data=&gt;key_2_name( d_variant ).
    s_variant = &lt;v&gt;-zl_object-&gt;to_data( ).
    APPEND s_variant TO fm_data-variants.
  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="UNANONYMIZE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="UnAnonymized component data"/>
     </TEXTS>
     <SOURCE>`
  FIELD-SYMBOLS &lt;v&gt; LIKE LINE OF variants.
  a0_maindata-cnam = sy-uname.
  LOOP AT variants ASSIGNING &lt;v&gt;.
    &lt;v&gt;-zl_object-&gt;unanonymize( ).
  ENDLOOP.</SOURCE>
    </ITEM>
   </METHODS>
   <TYPEGROUPS>
    <ITEM TYPEGROUP="ABAP" VERSION="1" IMPLICIT="X"/>
   </TYPEGROUPS>
   <TYPES>
    <ITEM CMPNAME="TO_MENUPAINTER" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="3" TYPE="ZAPLINK_MENUPAINTER_DATA" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Menu painter Data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TO_VARIANT" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="3" TYPE="ZAPLINK_VARI_RAW" R3RELEASE="701"/>
    <ITEM CMPNAME="TS_FM_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_fm_data,
* xx pour type doc
      header          TYPE progdir,
      texts           TYPE tt_trdirti,
      docs            TYPE tt_docs,
      textspool	      TYPE tt_txtp_textpools,
      dynpros	        TYPE tt_dynpros,
      menupainter	    TYPE to_menupainter,
      source          TYPE td_abapsource,
      variants        TYPE tt_vari_data,                    &quot; Issue 53
    END OF ts_fm_data
`</ITEM>
    <ITEM CMPNAME="TS_MAINDATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_maindata.
*    INCLUDE TYPE reposrc. &quot;The databae view &quot;REPOSRC&quot; is write-protected, so it cannot be changed.
  INCLUDE TYPE progdir.
  TYPES:
    END OF ts_maindata
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Program main data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_VARIANT" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">BEGIN OF ts_variant,
      zl_object TYPE to_variant,
      END OF ts_variant
`</ITEM>
    <ITEM CMPNAME="TT_TRDIRTI" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_trdirti TYPE SORTED TABLE OF trdirti WITH UNIQUE KEY sprsl
`</ITEM>
    <ITEM CMPNAME="TT_VARIANTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_variants TYPE STANDARD TABLE OF ts_variant WITH DEFAULT KEY
`</ITEM>
    <ITEM CMPNAME="TT_VARI_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">tt_vari_data TYPE STANDARD TABLE OF zaplink_vari_data=&gt;ts_fm_data WITH DEFAULT KEY
`</ITEM>
   </TYPES>
  </RAW>
 </ZL_OBJECT>
 <ZL_OBJECT CHECKSUM="7C62D56D7658A6C137A9CF38C1E9FCC6" CODE_SIGNATURE="DD8F3CADBACFF0D4382A85249B2B0931" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_VARI_DATA" TYPE="CLAS" VERSION="1.01">
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20100614" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="701">
    <INHERITANCE REFCLSNAME="ZAPLINK_RAW_DATA" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <TEXTS>
     <ITEM LANG="E" TEXT="Data for program&apos;s variants">U1&amp;FUNCTIONALITY&amp;
ASIs part of connector : ZAPLINK_PROGRAM
ASDefine XML structure of a Program
U1&amp;RELATIONS&amp;
AS
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AS
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
    </TEXTS>
   </A0_MAINDATA>
   <ALIASES>
    <ITEM CMPNAME="LINE_SEPARATOR" VERSION="1" EXPOSURE="2" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="LINE_SEPARATOR"/>
    <ITEM CMPNAME="TD_ABAPSOURCE" VERSION="1" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_ABAPSOURCE"/>
    <ITEM CMPNAME="TD_COMPNAME" VERSION="1" EXPOSURE="1" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_COMPNAME"/>
    <ITEM CMPNAME="TD_DOC_ID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DOC_ID"/>
    <ITEM CMPNAME="TR_DOCID" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TR_DOCID"/>
    <ITEM CMPNAME="TS_SOURCEASSTRUC" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TS_SOURCEASSTRUC"/>
    <ITEM CMPNAME="TT_DOCS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_DOCS"/>
    <ITEM CMPNAME="TT_DYNPROS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_DYNPROS"/>
    <ITEM CMPNAME="TT_LTEXTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_LTEXTS"/>
    <ITEM CMPNAME="TT_TEXTS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TEXTS"/>
    <ITEM CMPNAME="TT_TXTP_TEXTPOOLS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TT_TXTP_TEXTPOOLS"/>
   </ALIASES>
   <ATTRIBUTS>
    <ITEM CMPNAME="A0_MAINDATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TS_MAINDATA" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Program main data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="SCREENS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_SCREENS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Screens list"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TEXTS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_LTEXTS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Program texts"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TRANSPORT" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">BEGIN OF transport,
* FROM FORM BUILD_DESCRIPTION (LSVARF02)
** Variante transportieren
** Systemvariante sind immer geschtzt
** Variante nicht bei F4 anzeigen und transportieren
*  IF RSVAR-NODISPLAY EQ &apos;X&apos; AND RSVAR-TRANSPORT EQ &apos;X&apos;.
*    MOVE &apos;X&apos; TO VARID-TRANSPORT.
** Variante nicht bei F4 anzeigen und nicht transportieren
*  ELSEIF RSVAR-NODISPLAY EQ &apos;X&apos; AND RSVAR-TRANSPORT EQ SPACE.
*    MOVE &apos;N&apos; TO VARID-TRANSPORT.
** Variante bei F4 anzeigen und transportieren
*  ELSEIF RSVAR-NODISPLAY EQ SPACE AND RSVAR-TRANSPORT EQ &apos;X&apos;.
*    MOVE SPACE TO VARID-TRANSPORT.
** Ansonsten F
*  ELSEIF RSVAR-NODISPLAY EQ SPACE AND RSVAR-TRANSPORT EQ SPACE.
*    MOVE &apos;F&apos; TO VARID-TRANSPORT.
*  ENDIF.
      no_display  TYPE varid-transport VALUE &apos;N&apos;,           &quot;#EC NOTEXT
      hidden      TYPE varid-transport VALUE &apos;X&apos;,           &quot;#EC NOTEXT
      protected   TYPE varid-transport VALUE space,         &quot;#EC NOTEXT
      normal      TYPE varid-transport VALUE &apos;F&apos;,           &quot;#EC NOTEXT
    END OF transport
`</ITEM>
    <ITEM CMPNAME="VALUES" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="TT_PARAMS" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Values of parameters"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="VARIANT_PREFIX" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" ATTDECLTYP="2" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF variant_prefix,
      system    TYPE varid-variant VALUE &apos;SAP&amp;*&apos;,
      customer  TYPE varid-variant VALUE &apos;CUS&amp;*&apos;,
    END OF variant_prefix
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Variant reserved names"/>
     </TEXTS>
    </ITEM>
   </ATTRIBUTS>
   <FRIENDS>
    <ITEM REFCLSNAME="ZAPLINK_EASYXML" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <ITEM REFCLSNAME="ZAPLINK_PROGRAM" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <ITEM REFCLSNAME="ZAPLINK_PROG_DATA" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <ITEM REFCLSNAME="ZAPLINK_VARI_RAW" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
   </FRIENDS>
   <INTERFACES>
    <ITEM REFCLSNAME="ZAPLINK_DATATYPES" VERSION="1" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018" RELTYPE="1"/>
   </INTERFACES>
   <LOCAL>
    <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
    <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
    <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* in the implementation part of the class</MACROS>
   </LOCAL>
   <METHODS>
    <ITEM CMPNAME="ANONYMIZE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Anonymized component data"/>
     </TEXTS>
     <SOURCE>`
  CLEAR: a0_maindata-mandt, a0_maindata-ename, a0_maindata-edat, a0_maindata-etime, a0_maindata-aename, a0_maindata-aedat, a0_maindata-aetime.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="FROM_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert FM Data to object attributes"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Modules object Data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt     LIKE LINE OF texts.
  DATA t_docs    TYPE tt_docs.
  DATA s_value   LIKE LINE OF values.
  DATA s_scr     LIKE LINE OF screens.
  FIELD-SYMBOLS:
    &lt;s&gt;  LIKE LINE OF fm_data-screens,
    &lt;t&gt;  LIKE LINE OF fm_data-texts.

  a0_maindata = fm_data-header.
  values = fm_data-params.
  MODIFY values FROM s_value TRANSPORTING olen  FROM  to  text kind WHERE name &lt;&gt; space OR name = space.
* Event or other stuff might be present in VNAME when no TVARVC is used =&gt; Clean it
  MODIFY values FROM s_value TRANSPORTING vname WHERE vtype = space.

  LOOP AT fm_data-texts ASSIGNING &lt;t&gt;.
    CLEAR s_txt.    s_txt-lang = &lt;t&gt;-langu.   s_txt-text = &lt;t&gt;-vtext.
    INSERT s_txt INTO TABLE texts.
  ENDLOOP.

  screens = fm_data-screens.
*  LOOP AT fm_data-screens ASSIGNING &lt;s&gt;.
*    CLEAR s_scr.    s_scr-dynnr = &lt;s&gt;-dynnr.
*    INSERT s_scr INTO TABLE screens.
*  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="KEY_2_NAME" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert Key to Name (E071 Entrie)"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_VARIANT_KEY"/>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_COMPNAME"/>
     </PARAMETERS>
     <SOURCE>`
  result = data.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="NAME_2_KEY" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDDECLTYP="1" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert Name (E071 Entrie) to Key"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_COMPNAME"/>
      <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TS_VARIANT_KEY"/>
     </PARAMETERS>
     <SOURCE>`
  result = data.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="TO_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Convert object attributes to FM Data"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Modules object Data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA s_txt     LIKE LINE OF fm_data-texts.
  data s_scr     like LINE OF fm_data-screens.
  FIELD-SYMBOLS:
    &lt;s&gt;  like LINE OF screens,
    &lt;t&gt;  LIKE LINE OF texts.

  fm_data-header = a0_maindata.
  fm_data-params = values.

  LOOP AT texts ASSIGNING &lt;t&gt;.
    CLEAR s_txt.    s_txt-mandt = a0_maindata-mandt.    s_txt-report = a0_maindata-report.    s_txt-variant = a0_maindata-variant.    s_txt-langu = &lt;t&gt;-lang.   s_txt-vtext = &lt;t&gt;-text.
    INSERT s_txt INTO TABLE fm_data-texts.
  ENDLOOP.
  fm_data-screens = screens.
*  LOOP AT screens ASSIGNING &lt;s&gt;.
*    CLEAR s_scr.    &quot; s_scr-mandt = a0_maindata-mandt.    s_scr-report = a0_maindata-report.    s_scr-variant = a0_maindata-variant.
*    s_scr-dynnr = &lt;s&gt;-dynnr.
*    INSERT s_scr INTO TABLE fm_data-screens.
*  ENDLOOP.</SOURCE>
    </ITEM>
    <ITEM CMPNAME="UNANONYMIZE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="UnAnonymized component data"/>
     </TEXTS>
     <SOURCE>`
  a0_maindata-ename = a0_maindata-aename = sy-uname.</SOURCE>
    </ITEM>
   </METHODS>
   <TYPEGROUPS>
    <ITEM TYPEGROUP="ABAP" VERSION="1" IMPLICIT="X"/>
   </TYPEGROUPS>
   <TYPES>
    <ITEM CMPNAME="TR_STRING" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     tr_string TYPE RANGE OF string
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Values"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_FM_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="6 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_fm_data,
* xx pour type doc
      header          TYPE varid,
      texts           TYPE tt_varit,
      screens         TYPE tt_screens,
      params          TYPE tt_params,
    END OF ts_fm_data
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Data retrieve from FM"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_MAINDATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="7 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_maindata.
  INCLUDE TYPE varid.
  TYPES:
    END OF ts_maindata
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Program main data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_PARAM_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="4 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_param_data.
  INCLUDE TYPE vanz AS hdr.
  TYPES:
    value           TYPE string,
    values          TYPE tr_string,
    params          TYPE tr_string,
  END OF ts_param_data
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Parameters &amp; Select-options data"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_VARIANT_KEY" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="8 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     BEGIN OF ts_variant_key,
        program  TYPE varid-report,
        variant  TYPE varid-variant,
      END OF ts_variant_key
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Structure that define variant&apos;s key"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TT_PARAMS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="5 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     tt_params TYPE SORTED TABLE OF ts_param_data WITH UNIQUE KEY name
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Params list"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TT_SCREENS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     tt_screens TYPE SORTED TABLE OF rsdynnr WITH UNIQUE KEY dynnr
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Screens list"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TT_VARIT" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" CHANGEDBY="TBENSIAL" CHANGEDON="20101018" TYPTYPE="4" R3RELEASE="701">
     tt_varit TYPE SORTED TABLE OF varit WITH UNIQUE KEY langu
`
     <TEXTS>
      <ITEM LANG="E" TEXT="Variant&apos;s texts"/>
     </TEXTS>
    </ITEM>
   </TYPES>
  </RAW>
 </ZL_OBJECT>
 <ZL_OBJECT CHECKSUM="B62DD8D382599AAA9496FF6FA43FBF68" CODE_SIGNATURE="F5C71C89F8C68A02863FD039FA2CF723" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_VARI_RAW" TYPE="CLAS" VERSION="1.01">
  <DEPENDENCIES>
   <ITEM TYPE="CLAS" NAME="ZAPLINK_RAW"/>
  </DEPENDENCIES>
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20100614" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="701">
    <INHERITANCE REFCLSNAME="ZAPLINK_RAW" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
    <TEXTS>
     <ITEM LANG="E" TEXT="RAW object for Variant">U1&amp;FUNCTIONALITY&amp;
ASIs part of connector : ZAPLINK_PACKAGE
U1&amp;RELATIONS&amp;
AS
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AS
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
    </TEXTS>
   </A0_MAINDATA>
   <ATTRIBUTS>
    <ITEM CMPNAME="O_CX" VERSION="1" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_ROOT_EXCEPTION" R3RELEASE="701"/>
    <ITEM CMPNAME="O_MYCX" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" ATTDECLTYP="1" TYPTYPE="1" TYPE="TO_EXCEPTION" R3RELEASE="701"/>
   </ATTRIBUTS>
   <FRIENDS>
    <ITEM REFCLSNAME="ZAPLINK_EASYXML" VERSION="1" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20101018"/>
   </FRIENDS>
   <LOCAL>
    <TYPES>`
*&quot;* use this source file for any type declarations (class
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* implementation or private method&apos;s signature</TYPES>
    <IMPLEMENTATIONS>`
*&quot;* local class implementation for public class
*&quot;* use this source file for the implementation part of
*&quot;* local helper classes</IMPLEMENTATIONS>
    <MACROS>`
*&quot;* use this source file for any macro definitions you need
*&quot;* in the implementation part of the class</MACROS>
   </LOCAL>
   <METHODS>
    <ITEM CMPNAME="CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" MTDTYPE="2" MTDNEWEXC="X" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="CONSTRUCTOR"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" MTDTYPE="2" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARPASSTYP="1" TYPTYPE="1" TYPE="TS_FM_DATA" PAROPTIONL="X">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Module data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <EXCEPTIONS>
      <ITEM SCONAME="ZAPLINK_CX" VERSION="1" LANGU="E" MTDTYPE="2" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018">
       <TEXTS>
        <ITEM LANG="E" TEXT="ZAPlink Framework : Root exception class"/>
       </TEXTS>
      </ITEM>
     </EXCEPTIONS>
     <SOURCE>`
  DATA o_comp     TYPE to_component.
  DATA o_raw      TYPE to_mydata.
  DATA o_conn     TYPE to_connector.
  DATA s_variant  TYPE zaplink_vari_data=&gt;ts_variant_key.
  DATA d_name     TYPE td_compname.

  IF fm_data IS INITIAL.    &quot; create from ZL_EZXML
    CREATE OBJECT o_comp.
  ELSE.
    CREATE OBJECT o_comp.
    IF fm_data-header-variant CP zaplink_vari_data=&gt;variant_prefix-system OR fm_data-header-variant CP zaplink_vari_data=&gt;variant_prefix-customer.
      o_comp-&gt;set_type( zaplink_program=&gt;supportedtypes-sys_variant ).
    ELSE.
      o_comp-&gt;set_type( zaplink_program=&gt;supportedtypes-appl_variant ).
    ENDIF.
    s_variant-program = fm_data-header-report.
    s_variant-variant = fm_data-header-variant.
    d_name = zaplink_vari_data=&gt;key_2_name( s_variant ).
    o_comp-&gt;set_name( d_name ).
  ENDIF.

  CALL METHOD super-&gt;constructor
    EXPORTING
      o_comp = o_comp.

  CREATE OBJECT o_raw.
  raw ?= o_raw.
  IF NOT fm_data IS INITIAL.    o_raw-&gt;from_data( fm_data ).      CLEAR: o_raw-&gt;a0_maindata-report, o_raw-&gt;a0_maindata-variant.     ENDIF.

  CREATE OBJECT o_conn TYPE zaplink_program.
  update_connector_data( o_conn ).</SOURCE>
    </ITEM>
    <ITEM CMPNAME="TO_DATA" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " AUTHOR="TBENSIAL" CREATEDON="20101018" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="CONSTRUCTOR"/>
     </TEXTS>
     <PARAMETERS>
      <ITEM SCONAME="FM_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" PARDECLTYP="3" TYPTYPE="1" TYPE="TS_FM_DATA">
       <TEXTS>
        <ITEM LANG="E" TEXT="Function Module data"/>
       </TEXTS>
      </ITEM>
     </PARAMETERS>
     <SOURCE>`
  DATA o_raw      TYPE to_mydata.
  DATA s_variant  TYPE zaplink_vari_data=&gt;ts_variant_key.
  DATA d_name     TYPE td_compname.

  s_variant = zaplink_vari_data=&gt;name_2_key( me-&gt;name ).
  o_raw ?= raw.
  o_raw-&gt;a0_maindata-report = s_variant-program.
  o_raw-&gt;a0_maindata-variant = s_variant-variant.
  fm_data = o_raw-&gt;to_data( ).</SOURCE>
    </ITEM>
   </METHODS>
   <REDEFINITIONS>
    <ITEM REFCLSNAME="ZAPLINK_RAW" VERSION="1" MTDNAME="ANONYMIZE">
     <SOURCE>`
  DATA o_raw   TYPE to_mydata.

  IF raw IS BOUND.    o_raw ?= raw.   o_raw-&gt;anonymize( ).    ENDIF.
*  TRY.
  CALL METHOD super-&gt;anonymize.
*    CATCH zaplink_cx_container INTO o_mycx.
*      RAISE EXCEPTION o_mycx.
*  ENDTRY.</SOURCE>
    </ITEM>
   </REDEFINITIONS>
   <TYPES>
    <ITEM CMPNAME="TO_MYDATA" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="3" TYPE="ZAPLINK_VARI_DATA" R3RELEASE="701">
     <TEXTS>
      <ITEM LANG="E" TEXT="Commun Data for Class &amp; Interface"/>
     </TEXTS>
    </ITEM>
    <ITEM CMPNAME="TS_FM_DATA" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TBENSIAL" CREATEDON="20101018" TYPTYPE="1" TYPE="ZAPLINK_VARI_DATA=&gt;TS_FM_DATA" R3RELEASE="701"/>
   </TYPES>
  </RAW>
 </ZL_OBJECT>
 <ZL_OBJECT CHECKSUM="0139341E35EFE0F2159EB4EE38E85455" CONNECTOR="1FAC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_PROGRAM" TYPE="MSAG" VERSION="1.0">
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA MASTERLANG="E" RESPUSER="TBENSIAL"/>
   <MESSAGES>
    <ITEM MSGNR="000" NAME="TBENSIAL" DATUM="20101228" APPLICATION="DOKU" TYP="E" DOKFORM="S_DOCU_SHOW" DOKSTYLE="S_DOCUS1">
     <TEXTS>
      <ITEM LANGU="E" SHORT_TXT="Error &amp;1 on FORM import_var_selc : Screen part for &amp;2(&amp;3)">
       <LONG_TXT TDFRELES="700" TDLRELES="700" TDLINESIZE="072">U1&amp;CAUSE&amp;
ASLOAD REPORT P_REPORT PART &apos;SSCR&apos; return subrc &lt;&gt; 0 in perform
  load_sscr(rsdbrunt) event after a GENERATE REPORT P_REPORT
U1&amp;SYSTEM_RESPONSE&amp;
AS
U1&amp;WHAT_TO_DO&amp;
ASCheck that the report is OK, compile it if necessary.
U1&amp;SYS_ADMIN&amp;
AS</LONG_TXT>
      </ITEM>
     </TEXTS>
    </ITEM>
    <ITEM MSGNR="001" NAME="TBENSIAL" DATUM="20101228" APPLICATION="DOKU" TYP="E" DOKFORM="S_DOCU_SHOW" DOKSTYLE="S_DOCUS1">
     <TEXTS>
      <ITEM LANGU="E" SHORT_TXT="Error &amp;1 on FORM import_var_selc : Data part for &amp;2(&amp;3)">
       <LONG_TXT TDFRELES="700" TDLINESIZE="072">U1&amp;CAUSE&amp;
ASIMPORT ... FROM DATABASE VARI(VB) return a subrc &lt;&gt; 0 in PERFORM
  IMPORT_VARIANT_STATIC(RSDBSPVD).
U1&amp;SYSTEM_RESPONSE&amp;
AS
U1&amp;WHAT_TO_DO&amp;
ASCheck the report and his variants.
U1&amp;SYS_ADMIN&amp;
AS</LONG_TXT>
      </ITEM>
     </TEXTS>
    </ITEM>
    <ITEM MSGNR="002" NAME="TBENSIAL" DATUM="20101228" APPLICATION="DOKU" TYP="E" DOKFORM="S_DOCU_SHOW" DOKSTYLE="S_DOCUS1">
     <TEXTS>
      <ITEM LANGU="E" SHORT_TXT="Error &amp;1,&amp;2 on FORM %_import_vari_clnt for &amp;3(&amp;4)">
       <LONG_TXT TDFRELES="700" TDLINESIZE="072">U1&amp;CAUSE&amp;
ASFORM %_import_vari_clnt in the report is an auto generated form that
  source code can&apos;t be viewed.
ASYou might have miss something with calling parameters, try to debug MF
  RS_VARIANT_CONTENTS.
U1&amp;SYSTEM_RESPONSE&amp;
AS
U1&amp;WHAT_TO_DO&amp;
AS
U1&amp;SYS_ADMIN&amp;
AS</LONG_TXT>
      </ITEM>
     </TEXTS>
    </ITEM>
    <ITEM MSGNR="003" SELFDEF="3">
     <TEXTS>
      <ITEM LANGU="E" SHORT_TXT="Can&apos;t insert variant &apos;&amp;2&apos; for program &apos;&amp;1&apos;, because don&apos;t exist as active"/>
     </TEXTS>
    </ITEM>
   </MESSAGES>
   <TEXTS>
    <ITEM LANGU="E" SHORT_TXT="Message class for connector : ZAPLINK_PROGRAM"/>
   </TEXTS>
  </RAW>
 </ZL_OBJECT>
 <ZL_OBJECT CHECKSUM="916806A6A524EFE18AE83D3C17AEE090" CODE_SIGNATURE="25A38A791D67C6AE849DE60F9ADCAF80" CONNECTOR="AAAD0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_VARI" TYPE="PROG" VERSION="1.0">
  <DIRECTORY SRCSYSTEM="OD6" AUTHOR="TBENSIAL" DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
  <RAW>
   <A0_MAINDATA STATE="A" EDTX="X" VARCL="X" SUBC="S" CNAM="TBENSIAL" CDAT="20100614" UNAM="TBENSIAL" UDAT="20101018" VERN="000015" RSTAT="K" RMAND="200" RLOAD="E" FIXPT="X" SDATE="20111212" STIME="184211" IDATE="20101018" ITIME="170637" UCCHECK="X"/>
   <SOURCE>`
*&amp;---------------------------------------------------------------------*
*&amp; Subroutine Pool   ZAPLINK_VARI
*&amp;---------------------------------------------------------------------*
PROGRAM  zaplink_vari.

TYPE-POOLS: abap.
* Because might be include for standalone versions type and data name must be more unique
TYPES to_vari_object TYPE REF TO zaplink_program.
*TYPES to_vari_cx TYPE REF TO zaplink_cx.
DATA o_vari_prog TYPE to_vari_object.
*DATA o_vari_cx   TYPE to_vari_cx.
*DATA s_vari_text TYPE string.

*DEFINE mac_raise.
*  s_text = &amp;1.
*  create object o_vari_cx
*    exporting
*      textid = zaplink_cx=&gt;system_error
**        previous =
**        messages =
**        object =
**        subobject =
**        prev_cx =
**        ext_id =
**        _cx_list =
*      cx_name = s_vari_text.
*  raise exception o_vari_cx.
*END-OF-DEFINITION.

*&amp;---------------------------------------------------------------------*
*&amp;      Form  check_vari_form_exists
*&amp;---------------------------------------------------------------------*
FORM check_vari_form_exists  CHANGING ok TYPE abap_bool.
  ok = abap_true.
ENDFORM.                    &quot;check_vari_form_exists
*&amp;---------------------------------------------------------------------*
*&amp;      Form  set_object
*&amp;---------------------------------------------------------------------*
FORM set_object USING object TYPE to_vari_object
*              RAISING zaplink_cx
  .
*  ASSERT ID ZAPLINK CONDITION o_prog IS BOUND.
  CHECK o_vari_prog IS NOT BOUND.
*  IF o_prog IS BOUND.
*    mac_raise text-sko.
*  ENDIF.
  o_vari_prog = object.
ENDFORM.                    &quot;set_object

*&amp;---------------------------------------------------------------------*
*&amp;      Form  clear_object
*&amp;---------------------------------------------------------------------*
FORM clear_object USING object TYPE to_vari_object
*                RAISING zaplink_cx
  .
*  ASSERT ID ZAPLINK CONDITION o_VARI_prog &lt;&gt; object.
  CHECK o_vari_prog = object.
*  IF o_prog &lt;&gt; object.
*    mac_raise text-cko.
*  ENDIF.
  CLEAR o_vari_prog.
ENDFORM.                    &quot;clear_object
*&amp;---------------------------------------------------------------------*
*&amp;      Form  get_val
*&amp;---------------------------------------------------------------------*
FORM get_val_p USING p_param value(p_text) p_subrc
*             RAISING zaplink_cx
  .
  DATA l_value TYPE string.
*  ASSERT ID ZAPLINK CONDITION NOT o_prog IS BOUND.
  CHECK o_vari_prog IS BOUND.
*  IF NOT o_prog IS BOUND.
*    mac_raise text-nse.
*  ENDIF.
  CHECK NOT p_param IS INITIAL.
  l_value = p_param.
  o_vari_prog-&gt;get_param_value( l_value ).
ENDFORM.                    &quot;get_val
*&amp;---------------------------------------------------------------------*
*&amp;      Form  get_val_S
*&amp;---------------------------------------------------------------------*
FORM get_val_s TABLES p_selopt                              &quot;#EC *
                USING p_sign p_option p_low p_high
                      p_desc STRUCTURE rsselint p_subrc
*              RAISING zaplink_cx
  .
*  ASSERT ID ZAPLINK CONDITION NOT o_prog IS BOUND.
  CHECK o_vari_prog IS BOUND.
*  IF NOT o_prog IS BOUND.
*    mac_raise text-nse.
*  ENDIF.
  o_vari_prog-&gt;get_selectoption_value( p_selopt[] ).

ENDFORM.                    &quot;get_val_s
*&amp;---------------------------------------------------------------------*
*&amp;      Form  set_val_p
*&amp;---------------------------------------------------------------------*
FORM set_val_p USING p_param value(p_text) p_subrc
*             RAISING zaplink_cx
  .
  DATA l_value TYPE string.
*  ASSERT ID ZAPLINK CONDITION NOT o_prog IS BOUND.
  CHECK o_vari_prog IS BOUND.
*  IF NOT o_prog IS BOUND.
*    mac_raise text-nse.
*  ENDIF.
  l_value = o_vari_prog-&gt;set_param_value( ).
*  CHECK NOT l_value IS INITIAL.    &quot; always set value : Clearing (blank in variant) default not null value
  p_param = l_value.
ENDFORM.                    &quot;set_val_p
*&amp;---------------------------------------------------------------------*
*&amp;      Form  set_val_s
*&amp;---------------------------------------------------------------------*
FORM set_val_s TABLES p_selopt                              &quot;#EC *
                USING p_sign p_option p_low p_high
                      p_desc STRUCTURE rsselint p_subrc
*              RAISING zaplink_cx
  .
  DATA t_value  TYPE zaplink_program=&gt;tr_so_value.
  FIELD-SYMBOLS:
    &lt;v&gt; LIKE LINE OF t_value.

*  ASSERT ID ZAPLINK CONDITION NOT o_prog IS BOUND.
  CHECK o_vari_prog IS BOUND.
*  IF NOT o_prog IS BOUND.
*    mac_raise text-nse.
*  ENDIF.
  t_value = o_vari_prog-&gt;set_selectoption_value( ).
  refresh p_selopt.       &quot; always set value : Clearing (blank in variant) default not null value
  LOOP AT t_value ASSIGNING &lt;v&gt;.
    CLEAR p_selopt.   MOVE-CORRESPONDING &lt;v&gt; TO p_selopt.   APPEND p_selopt.
  ENDLOOP.

ENDFORM.                    &quot;set_val_s</SOURCE>
   <TEXTSPOOL>
    <ITEM ID="I" KEY="CKO">
     <TEXTS>
      <ITEM LANGU="E" ENTRY="Object to clear are not the same" LENGTH="50 "/>
     </TEXTS>
    </ITEM>
    <ITEM ID="I" KEY="NSE">
     <TEXTS>
      <ITEM LANGU="E" ENTRY="Object is not set" LENGTH="50 "/>
     </TEXTS>
    </ITEM>
    <ITEM ID="I" KEY="SKO">
     <TEXTS>
      <ITEM LANGU="E" ENTRY="Object already defined" LENGTH="50 "/>
     </TEXTS>
    </ITEM>
    <ITEM ID="R">
     <TEXTS>
      <ITEM LANGU="E" ENTRY="Subroutine Pool for variant" LENGTH="27 "/>
     </TEXTS>
    </ITEM>
   </TEXTSPOOL>
  </RAW>
 </ZL_OBJECT>
</CONTAINER>
